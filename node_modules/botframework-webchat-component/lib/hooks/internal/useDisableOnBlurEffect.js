"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = useDisableOnBlurEffect;

var _react = require("react");

// Because different browser handling disabled-but-focused UI different, we are implementing a more general solution.
// When the button is being disabled:
// - If it is not currently focused, we will set "disabled";
// - If it is currently focused, we will not set "disabled" until it is blurred (focus moved away).
function disableElement(element) {
  element.setAttribute('disabled', 'disabled');
}

function useDisableOnBlurEffect(targetRef, disabled) {
  (0, _react.useEffect)(function () {
    if (disabled) {
      var current = targetRef.current;

      if (current) {
        if (document.activeElement !== current) {
          current.setAttribute('disabled', 'disabled');
          return function () {
            return current.removeAttribute('disabled');
          };
        }

        var blurHandler = disableElement.bind(null, current);
        current.addEventListener('blur', blurHandler);
        return function () {
          current.removeAttribute('disabled');
          current.removeEventListener('blur', blurHandler);
        };
      }
    }
  }, [disabled, targetRef]);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ob29rcy9pbnRlcm5hbC91c2VEaXNhYmxlT25CbHVyRWZmZWN0LmpzIl0sIm5hbWVzIjpbImRpc2FibGVFbGVtZW50IiwiZWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInVzZURpc2FibGVPbkJsdXJFZmZlY3QiLCJ0YXJnZXRSZWYiLCJkaXNhYmxlZCIsImN1cnJlbnQiLCJkb2N1bWVudCIsImFjdGl2ZUVsZW1lbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJibHVySGFuZGxlciIsImJpbmQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBU0EsY0FBVCxDQUF3QkMsT0FBeEIsRUFBaUM7QUFDL0JBLEVBQUFBLE9BQU8sQ0FBQ0MsWUFBUixDQUFxQixVQUFyQixFQUFpQyxVQUFqQztBQUNEOztBQUVjLFNBQVNDLHNCQUFULENBQWdDQyxTQUFoQyxFQUEyQ0MsUUFBM0MsRUFBcUQ7QUFDbEUsd0JBQVUsWUFBTTtBQUNkLFFBQUlBLFFBQUosRUFBYztBQUFBLFVBQ0pDLE9BREksR0FDUUYsU0FEUixDQUNKRSxPQURJOztBQUdaLFVBQUlBLE9BQUosRUFBYTtBQUNYLFlBQUlDLFFBQVEsQ0FBQ0MsYUFBVCxLQUEyQkYsT0FBL0IsRUFBd0M7QUFDdENBLFVBQUFBLE9BQU8sQ0FBQ0osWUFBUixDQUFxQixVQUFyQixFQUFpQyxVQUFqQztBQUVBLGlCQUFPO0FBQUEsbUJBQU1JLE9BQU8sQ0FBQ0csZUFBUixDQUF3QixVQUF4QixDQUFOO0FBQUEsV0FBUDtBQUNEOztBQUVELFlBQU1DLFdBQVcsR0FBR1YsY0FBYyxDQUFDVyxJQUFmLENBQW9CLElBQXBCLEVBQTBCTCxPQUExQixDQUFwQjtBQUVBQSxRQUFBQSxPQUFPLENBQUNNLGdCQUFSLENBQXlCLE1BQXpCLEVBQWlDRixXQUFqQztBQUVBLGVBQU8sWUFBTTtBQUNYSixVQUFBQSxPQUFPLENBQUNHLGVBQVIsQ0FBd0IsVUFBeEI7QUFDQUgsVUFBQUEsT0FBTyxDQUFDTyxtQkFBUixDQUE0QixNQUE1QixFQUFvQ0gsV0FBcEM7QUFDRCxTQUhEO0FBSUQ7QUFDRjtBQUNGLEdBckJELEVBcUJHLENBQUNMLFFBQUQsRUFBV0QsU0FBWCxDQXJCSDtBQXNCRCIsInNvdXJjZVJvb3QiOiJjb21wb25lbnQ6Ly8vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuXG4vLyBCZWNhdXNlIGRpZmZlcmVudCBicm93c2VyIGhhbmRsaW5nIGRpc2FibGVkLWJ1dC1mb2N1c2VkIFVJIGRpZmZlcmVudCwgd2UgYXJlIGltcGxlbWVudGluZyBhIG1vcmUgZ2VuZXJhbCBzb2x1dGlvbi5cbi8vIFdoZW4gdGhlIGJ1dHRvbiBpcyBiZWluZyBkaXNhYmxlZDpcbi8vIC0gSWYgaXQgaXMgbm90IGN1cnJlbnRseSBmb2N1c2VkLCB3ZSB3aWxsIHNldCBcImRpc2FibGVkXCI7XG4vLyAtIElmIGl0IGlzIGN1cnJlbnRseSBmb2N1c2VkLCB3ZSB3aWxsIG5vdCBzZXQgXCJkaXNhYmxlZFwiIHVudGlsIGl0IGlzIGJsdXJyZWQgKGZvY3VzIG1vdmVkIGF3YXkpLlxuZnVuY3Rpb24gZGlzYWJsZUVsZW1lbnQoZWxlbWVudCkge1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlRGlzYWJsZU9uQmx1ckVmZmVjdCh0YXJnZXRSZWYsIGRpc2FibGVkKSB7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICBjb25zdCB7IGN1cnJlbnQgfSA9IHRhcmdldFJlZjtcblxuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGN1cnJlbnQpIHtcbiAgICAgICAgICBjdXJyZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuICAgICAgICAgIHJldHVybiAoKSA9PiBjdXJyZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJsdXJIYW5kbGVyID0gZGlzYWJsZUVsZW1lbnQuYmluZChudWxsLCBjdXJyZW50KTtcblxuICAgICAgICBjdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBibHVySGFuZGxlcik7XG5cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICBjdXJyZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgICBjdXJyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCBibHVySGFuZGxlcik7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICB9LCBbZGlzYWJsZWQsIHRhcmdldFJlZl0pO1xufVxuIl19