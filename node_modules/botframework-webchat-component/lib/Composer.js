"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactSay = require("react-say");

var _reactScrollToBottom = require("react-scroll-to-bottom");

var _glamor = require("glamor");

var _reactRedux = require("react-redux");

var _markdownIt = _interopRequireDefault(require("markdown-it"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireWildcard(require("react"));

var _simpleUpdateIn = _interopRequireDefault(require("simple-update-in"));

var _createActivityRenderer = _interopRequireDefault(require("./Middleware/createActivityRenderer"));

var _createActivityStatusRenderer = _interopRequireDefault(require("./Middleware/createActivityStatusRenderer"));

var _createAttachmentRenderer = _interopRequireDefault(require("./Middleware/createAttachmentRenderer"));

var _createAvatarRenderer = _interopRequireDefault(require("./Middleware/createAvatarRenderer"));

var _createCustomEvent = _interopRequireDefault(require("./Utils/createCustomEvent"));

var _createToastRenderer = _interopRequireDefault(require("./Middleware/createToastRenderer"));

var _createTypingIndicatorRenderer = _interopRequireDefault(require("./Middleware/createTypingIndicatorRenderer"));

var _ErrorBoundary = _interopRequireDefault(require("./ErrorBoundary"));

var _getAllLocalizedStrings = _interopRequireDefault(require("./Localization/getAllLocalizedStrings"));

var _isObject = _interopRequireDefault(require("./Utils/isObject"));

var _normalizeLanguage = _interopRequireDefault(require("./Utils/normalizeLanguage"));

var _PrecompiledGlobalize = _interopRequireDefault(require("./Utils/PrecompiledGlobalize"));

var _useReferenceGrammarID = _interopRequireDefault(require("./hooks/useReferenceGrammarID"));

var _botframeworkWebchatCore = require("botframework-webchat-core");

var _addTargetBlankToHyperlinksMarkdown = _interopRequireDefault(require("./Utils/addTargetBlankToHyperlinksMarkdown"));

var _concatMiddleware = _interopRequireDefault(require("./Middleware/concatMiddleware"));

var _createCoreMiddleware = _interopRequireDefault(require("./Middleware/CardAction/createCoreMiddleware"));

var _createCoreMiddleware2 = _interopRequireDefault(require("./Middleware/GroupActivities/createCoreMiddleware"));

var _createStyleSet = _interopRequireDefault(require("./Styles/createStyleSet"));

var _defaultSelectVoice = _interopRequireDefault(require("./defaultSelectVoice"));

var _Dictation = _interopRequireDefault(require("./Dictation"));

var _mapMap = _interopRequireDefault(require("./Utils/mapMap"));

var _observableToPromise = _interopRequireDefault(require("./Utils/observableToPromise"));

var _Tracker = _interopRequireDefault(require("./Tracker"));

var _WebChatReduxContext = _interopRequireWildcard(require("./WebChatReduxContext"));

var _WebChatUIContext = _interopRequireDefault(require("./WebChatUIContext"));

var _BypassSpeechSynthesisPonyfill = require("./Speech/BypassSpeechSynthesisPonyfill");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

// List of Redux actions factory we are hoisting as Web Chat functions
var DISPATCHERS = {
  clearSuggestedActions: _botframeworkWebchatCore.clearSuggestedActions,
  dismissNotification: _botframeworkWebchatCore.dismissNotification,
  emitTypingIndicator: _botframeworkWebchatCore.emitTypingIndicator,
  markActivity: _botframeworkWebchatCore.markActivity,
  postActivity: _botframeworkWebchatCore.postActivity,
  sendEvent: _botframeworkWebchatCore.sendEvent,
  sendFiles: _botframeworkWebchatCore.sendFiles,
  sendMessage: _botframeworkWebchatCore.sendMessage,
  sendMessageBack: _botframeworkWebchatCore.sendMessageBack,
  sendPostBack: _botframeworkWebchatCore.sendPostBack,
  setDictateInterims: _botframeworkWebchatCore.setDictateInterims,
  setDictateState: _botframeworkWebchatCore.setDictateState,
  setNotification: _botframeworkWebchatCore.setNotification,
  setSendBox: _botframeworkWebchatCore.setSendBox,
  setSendTimeout: _botframeworkWebchatCore.setSendTimeout,
  startDictate: _botframeworkWebchatCore.startDictate,
  startSpeakingActivity: _botframeworkWebchatCore.startSpeakingActivity,
  stopDictate: _botframeworkWebchatCore.stopDictate,
  stopSpeakingActivity: _botframeworkWebchatCore.stopSpeakingActivity,
  submitSendBox: _botframeworkWebchatCore.submitSendBox
};

function styleSetToClassNames(styleSet) {
  return (0, _mapMap.default)(styleSet, function (style, key) {
    return key === 'options' ? style : (0, _glamor.css)(style);
  });
}

function createCardActionContext(_ref) {
  var cardActionMiddleware = _ref.cardActionMiddleware,
      directLine = _ref.directLine,
      dispatch = _ref.dispatch;
  var runMiddleware = (0, _concatMiddleware.default)(cardActionMiddleware, (0, _createCoreMiddleware.default)())({
    dispatch: dispatch
  });
  return {
    onCardAction: function onCardAction(cardAction) {
      var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
          target = _ref2.target;

      return runMiddleware(function (_ref3) {
        var type = _ref3.cardAction.type;
        throw new Error("Web Chat: received unknown card action \"".concat(type, "\""));
      })({
        cardAction: cardAction,
        getSignInUrl: cardAction.type === 'signin' ? function () {
          var value = cardAction.value;

          if (directLine.getSessionId) {
            // TODO: [P3] We should change this one to async/await.
            //       This is the first place in this project to use async.
            //       Thus, we need to add @babel/plugin-transform-runtime and @babel/runtime.
            return (0, _observableToPromise.default)(directLine.getSessionId()).then(function (sessionId) {
              return "".concat(value).concat(encodeURIComponent("&code_challenge=".concat(sessionId)));
            });
          }

          console.warn('botframework-webchat: OAuth is not supported on this Direct Line adapter.');
          return value;
        } : null,
        target: target
      });
    }
  };
}

function createFocusContext(_ref4) {
  var sendBoxFocusRef = _ref4.sendBoxFocusRef,
      transcriptFocusRef = _ref4.transcriptFocusRef;
  return {
    focus: function focus(where) {
      var ref = where === 'sendBox' || where === 'sendBoxWithoutKeyboard' ? sendBoxFocusRef : transcriptFocusRef;

      var _ref5 = ref || {},
          current = _ref5.current;

      if (current) {
        if (where === 'sendBoxWithoutKeyboard') {
          // To not activate the virtual keyboard while changing focus to an input, we will temporarily set it as read-only and flip it back.
          // https://stackoverflow.com/questions/7610758/prevent-iphone-default-keyboard-when-focusing-an-input/7610923
          var readOnly = current.getAttribute('readonly');
          current.setAttribute('readonly', 'readonly');
          setTimeout(function () {
            current.focus();
            readOnly ? current.setAttribute('readonly', readOnly) : current.removeAttribute('readonly');
          }, 0);
        } else {
          current.focus();
        }
      }
    }
  };
}

function createGroupActivitiesContext(_ref6) {
  var groupActivitiesMiddleware = _ref6.groupActivitiesMiddleware,
      groupTimestamp = _ref6.groupTimestamp;
  var runMiddleware = (0, _concatMiddleware.default)(groupActivitiesMiddleware, (0, _createCoreMiddleware2.default)({
    groupTimestamp: groupTimestamp
  }))()(function () {
    throw new Error('botframework-webchat internal: No middleware is execute for groupActivities.');
  });
  return {
    groupActivities: function groupActivities(_ref7) {
      var activities = _ref7.activities;
      return runMiddleware({
        activities: activities
      });
    }
  };
}

function mergeStringsOverrides(localizedStrings, language, overrideLocalizedStrings) {
  if (!overrideLocalizedStrings) {
    return localizedStrings;
  } else if (typeof overrideLocalizedStrings === 'function') {
    var merged = overrideLocalizedStrings(localizedStrings, language);

    if (!(0, _isObject.default)(merged)) {
      throw new Error('botframework-webchat: overrideLocalizedStrings function must return an object.');
    }

    return merged;
  }

  if (!(0, _isObject.default)(overrideLocalizedStrings)) {
    throw new Error('botframework-webchat: overrideLocalizedStrings must be either a function, an object, or falsy.');
  }

  return _objectSpread(_objectSpread({}, localizedStrings), overrideLocalizedStrings);
}

var Composer = function Composer(_ref8) {
  var activityMiddleware = _ref8.activityMiddleware,
      activityRenderer = _ref8.activityRenderer,
      activityStatusMiddleware = _ref8.activityStatusMiddleware,
      activityStatusRenderer = _ref8.activityStatusRenderer,
      attachmentMiddleware = _ref8.attachmentMiddleware,
      attachmentRenderer = _ref8.attachmentRenderer,
      avatarMiddleware = _ref8.avatarMiddleware,
      avatarRenderer = _ref8.avatarRenderer,
      cardActionMiddleware = _ref8.cardActionMiddleware,
      children = _ref8.children,
      dir = _ref8.dir,
      directLine = _ref8.directLine,
      disabled = _ref8.disabled,
      extraStyleSet = _ref8.extraStyleSet,
      grammars = _ref8.grammars,
      groupActivitiesMiddleware = _ref8.groupActivitiesMiddleware,
      groupTimestamp = _ref8.groupTimestamp,
      locale = _ref8.locale,
      onTelemetry = _ref8.onTelemetry,
      overrideLocalizedStrings = _ref8.overrideLocalizedStrings,
      renderMarkdown = _ref8.renderMarkdown,
      selectVoice = _ref8.selectVoice,
      sendTimeout = _ref8.sendTimeout,
      sendTypingIndicator = _ref8.sendTypingIndicator,
      styleOptions = _ref8.styleOptions,
      styleSet = _ref8.styleSet,
      suggestedActionsAccessKey = _ref8.suggestedActionsAccessKey,
      toastMiddleware = _ref8.toastMiddleware,
      toastRenderer = _ref8.toastRenderer,
      typingIndicatorMiddleware = _ref8.typingIndicatorMiddleware,
      typingIndicatorRenderer = _ref8.typingIndicatorRenderer,
      userID = _ref8.userID,
      username = _ref8.username,
      webSpeechPonyfillFactory = _ref8.webSpeechPonyfillFactory;

  var _useState = (0, _react.useState)(),
      _useState2 = _slicedToArray(_useState, 2),
      dictateAbortable = _useState2[0],
      setDictateAbortable = _useState2[1];

  var _useReferenceGrammarI = (0, _useReferenceGrammarID.default)(),
      _useReferenceGrammarI2 = _slicedToArray(_useReferenceGrammarI, 1),
      referenceGrammarID = _useReferenceGrammarI2[0];

  var dispatch = (0, _WebChatReduxContext.useDispatch)();
  var sendBoxFocusRef = (0, _react.useRef)();
  var telemetryDimensionsRef = (0, _react.useRef)({});
  var transcriptFocusRef = (0, _react.useRef)();
  var patchedDir = (0, _react.useMemo)(function () {
    return dir === 'ltr' || dir === 'rtl' ? dir : 'auto';
  }, [dir]);
  var patchedGrammars = (0, _react.useMemo)(function () {
    return grammars || [];
  }, [grammars]);
  var patchedStyleOptions = (0, _react.useMemo)(function () {
    var patchedStyleOptions = _objectSpread({}, styleOptions);

    if (typeof groupTimestamp !== 'undefined' && typeof patchedStyleOptions.groupTimestamp === 'undefined') {
      console.warn('Web Chat: "groupTimestamp" has been moved to "styleOptions". This deprecation migration will be removed on or after January 1 2022.');
      patchedStyleOptions.groupTimestamp = groupTimestamp;
    }

    if (typeof sendTimeout !== 'undefined' && typeof patchedStyleOptions.sendTimeout === 'undefined') {
      console.warn('Web Chat: "sendTimeout" has been moved to "styleOptions". This deprecation migration will be removed on or after January 1 2022.');
      patchedStyleOptions.sendTimeout = sendTimeout;
    }

    if (styleOptions.slowConnectionAfter < 0) {
      console.warn('Web Chat: "slowConnectionAfter" cannot be negative, will set to 0.');
      patchedStyleOptions.slowConnectionAfter = 0;
    }

    return patchedStyleOptions;
  }, [groupTimestamp, sendTimeout, styleOptions]);
  (0, _react.useEffect)(function () {
    dispatch((0, _botframeworkWebchatCore.setLanguage)(locale));
  }, [dispatch, locale]);
  (0, _react.useEffect)(function () {
    typeof sendTimeout === 'number' && dispatch((0, _botframeworkWebchatCore.setSendTimeout)(sendTimeout));
  }, [dispatch, sendTimeout]);
  (0, _react.useEffect)(function () {
    dispatch((0, _botframeworkWebchatCore.setSendTypingIndicator)(!!sendTypingIndicator));
  }, [dispatch, sendTypingIndicator]);
  (0, _react.useEffect)(function () {
    dispatch((0, _botframeworkWebchatCore.connect)({
      directLine: directLine,
      userID: userID,
      username: username
    }));
    return function () {
      // TODO: [P3] disconnect() is an async call (pending -> fulfilled), we need to wait, or change it to reconnect()
      dispatch((0, _botframeworkWebchatCore.disconnect)());
    };
  }, [dispatch, directLine, userID, username]);
  var internalMarkdownIt = (0, _react.useMemo)(function () {
    return new _markdownIt.default();
  }, []);
  var internalRenderMarkdownInline = (0, _react.useMemo)(function () {
    return function (markdown) {
      var tree = internalMarkdownIt.parseInline(markdown); // We should add rel="noopener noreferrer" and target="_blank"

      var patchedTree = (0, _addTargetBlankToHyperlinksMarkdown.default)(tree);
      return internalMarkdownIt.renderer.render(patchedTree);
    };
  }, [internalMarkdownIt]);
  var cardActionContext = (0, _react.useMemo)(function () {
    return createCardActionContext({
      cardActionMiddleware: cardActionMiddleware,
      directLine: directLine,
      dispatch: dispatch
    });
  }, [cardActionMiddleware, directLine, dispatch]);
  var patchedSelectVoice = (0, _react.useCallback)(selectVoice || _defaultSelectVoice.default.bind(null, {
    language: locale
  }), [selectVoice]);
  var focusContext = (0, _react.useMemo)(function () {
    return createFocusContext({
      sendBoxFocusRef: sendBoxFocusRef,
      transcriptFocusRef: transcriptFocusRef
    });
  }, [sendBoxFocusRef, transcriptFocusRef]);
  var patchedStyleSet = (0, _react.useMemo)(function () {
    return styleSetToClassNames(_objectSpread(_objectSpread({}, styleSet || (0, _createStyleSet.default)(patchedStyleOptions)), extraStyleSet));
  }, [extraStyleSet, patchedStyleOptions, styleSet]);
  var groupActivitiesContext = (0, _react.useMemo)(function () {
    return createGroupActivitiesContext({
      groupActivitiesMiddleware: groupActivitiesMiddleware,
      groupTimestamp: patchedStyleSet.options.groupTimestamp
    });
  }, [groupActivitiesMiddleware, patchedStyleSet.options.groupTimestamp]);
  var hoistedDispatchers = (0, _react.useMemo)(function () {
    return (0, _mapMap.default)(DISPATCHERS, function (dispatcher) {
      return function () {
        return dispatch(dispatcher.apply(void 0, arguments));
      };
    });
  }, [dispatch]);
  var webSpeechPonyfill = (0, _react.useMemo)(function () {
    var ponyfill = webSpeechPonyfillFactory && webSpeechPonyfillFactory({
      referenceGrammarID: referenceGrammarID
    });

    var _ref9 = ponyfill || {},
        speechSynthesis = _ref9.speechSynthesis,
        SpeechSynthesisUtterance = _ref9.SpeechSynthesisUtterance;

    return _objectSpread(_objectSpread({}, ponyfill), {}, {
      speechSynthesis: speechSynthesis || _BypassSpeechSynthesisPonyfill.speechSynthesis,
      SpeechSynthesisUtterance: SpeechSynthesisUtterance || _BypassSpeechSynthesisPonyfill.SpeechSynthesisUtterance
    });
  }, [referenceGrammarID, webSpeechPonyfillFactory]);
  var dictationOnError = (0, _react.useCallback)(function (err) {
    console.error(err);
  }, []);
  var patchedLocalizedStrings = (0, _react.useMemo)(function () {
    return mergeStringsOverrides((0, _getAllLocalizedStrings.default)()[(0, _normalizeLanguage.default)(locale)], locale, overrideLocalizedStrings);
  }, [locale, overrideLocalizedStrings]);
  var localizedGlobalize = (0, _react.useMemo)(function () {
    var _ref10 = patchedLocalizedStrings || {},
        GLOBALIZE = _ref10.GLOBALIZE,
        GLOBALIZE_LANGUAGE = _ref10.GLOBALIZE_LANGUAGE;

    return GLOBALIZE || GLOBALIZE_LANGUAGE && (0, _PrecompiledGlobalize.default)(GLOBALIZE_LANGUAGE) || (0, _PrecompiledGlobalize.default)('en');
  }, [patchedLocalizedStrings]);
  var trackDimension = (0, _react.useCallback)(function (name, data) {
    if (!name || typeof name !== 'string') {
      return console.warn('botframework-webchat: Telemetry dimension name must be a string.');
    }

    var type = _typeof(data);

    if (type !== 'string' && type !== 'undefined') {
      return console.warn('botframework-webchat: Telemetry dimension data must be a string or undefined.');
    }

    telemetryDimensionsRef.current = (0, _simpleUpdateIn.default)(telemetryDimensionsRef.current, [name], type === 'undefined' ? data : function () {
      return data;
    });
  }, [telemetryDimensionsRef]);
  var patchedActivityRenderer = (0, _react.useMemo)(function () {
    activityRenderer && console.warn('Web Chat: "activityRenderer" is deprecated and will be removed on 2020-06-15, please use "activityMiddleware" instead.');
    return activityRenderer || (0, _createActivityRenderer.default)(activityMiddleware);
  }, [activityMiddleware, activityRenderer]);
  var patchedActivityStatusRenderer = (0, _react.useMemo)(function () {
    activityStatusRenderer && console.warn('Web Chat: "activityStatusRenderer" is deprecated and will be removed on 2020-06-15, please use "activityStatusMiddleware" instead.');
    return activityStatusRenderer || (0, _createActivityStatusRenderer.default)(activityStatusMiddleware);
  }, [activityStatusMiddleware, activityStatusRenderer]);
  var patchedAttachmentRenderer = (0, _react.useMemo)(function () {
    attachmentRenderer && console.warn('Web Chat: "attachmentRenderer" is deprecated and will be removed on 2020-06-15, please use "attachmentMiddleware" instead.');
    return attachmentRenderer || (0, _createAttachmentRenderer.default)(attachmentMiddleware);
  }, [attachmentMiddleware, attachmentRenderer]);
  var patchedAvatarRenderer = (0, _react.useMemo)(function () {
    avatarRenderer && console.warn('Web Chat: "avatarRenderer" is deprecated and will be removed on 2020-06-15, please use "avatarMiddleware" instead.');
    return avatarRenderer || (0, _createAvatarRenderer.default)(avatarMiddleware);
  }, [avatarMiddleware, avatarRenderer]);
  var patchedToastRenderer = (0, _react.useMemo)(function () {
    toastRenderer && console.warn('Web Chat: "toastRenderer" is deprecated and will be removed on 2020-06-15, please use "toastMiddleware" instead.');
    return toastRenderer || (0, _createToastRenderer.default)(toastMiddleware);
  }, [toastMiddleware, toastRenderer]);
  var patchedTypingIndicatorRenderer = (0, _react.useMemo)(function () {
    typingIndicatorRenderer && console.warn('Web Chat: "typingIndicatorRenderer" is deprecated and will be removed on 2020-06-15, please use "typingIndicatorMiddleware" instead.');
    return typingIndicatorRenderer || (0, _createTypingIndicatorRenderer.default)(typingIndicatorMiddleware);
  }, [typingIndicatorMiddleware, typingIndicatorRenderer]);
  var transcriptActivityElementsRef = (0, _react.useRef)([]);
  var transcriptRootElementRef = (0, _react.useRef)(); // This is a heavy function, and it is expected to be only called when there is a need to recreate business logic, e.g.
  // - User ID changed, causing all send* functions to be updated
  // - send
  // TODO: [P3] We should think about if we allow the user to change onSendBoxValueChanged/sendBoxValue, e.g.
  // 1. Turns text into UPPERCASE
  // 2. Filter out profanity
  // TODO: [P4] Revisit all members of context
  //       This context should consist of members that are not in the Redux store
  //       i.e. members that are not interested in other types of UIs

  var context = (0, _react.useMemo)(function () {
    return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, cardActionContext), focusContext), groupActivitiesContext), hoistedDispatchers), {}, {
      activityRenderer: patchedActivityRenderer,
      activityStatusRenderer: patchedActivityStatusRenderer,
      attachmentRenderer: patchedAttachmentRenderer,
      avatarRenderer: patchedAvatarRenderer,
      dictateAbortable: dictateAbortable,
      dir: patchedDir,
      directLine: directLine,
      disabled: disabled,
      grammars: patchedGrammars,
      internalMarkdownItState: [internalMarkdownIt],
      internalRenderMarkdownInline: internalRenderMarkdownInline,
      language: locale,
      localizedGlobalizeState: [localizedGlobalize],
      localizedStrings: patchedLocalizedStrings,
      onTelemetry: onTelemetry,
      renderMarkdown: renderMarkdown,
      selectVoice: patchedSelectVoice,
      sendBoxFocusRef: sendBoxFocusRef,
      sendTypingIndicator: sendTypingIndicator,
      setDictateAbortable: setDictateAbortable,
      styleOptions: styleOptions,
      styleSet: patchedStyleSet,
      suggestedActionsAccessKey: suggestedActionsAccessKey,
      telemetryDimensionsRef: telemetryDimensionsRef,
      toastRenderer: patchedToastRenderer,
      trackDimension: trackDimension,
      transcriptActivityElementsRef: transcriptActivityElementsRef,
      transcriptFocusRef: transcriptFocusRef,
      transcriptRootElementRef: transcriptRootElementRef,
      typingIndicatorRenderer: patchedTypingIndicatorRenderer,
      userID: userID,
      username: username,
      webSpeechPonyfill: webSpeechPonyfill
    });
  }, [cardActionContext, dictateAbortable, directLine, disabled, focusContext, groupActivitiesContext, hoistedDispatchers, internalMarkdownIt, internalRenderMarkdownInline, locale, localizedGlobalize, onTelemetry, patchedActivityRenderer, patchedActivityStatusRenderer, patchedAttachmentRenderer, patchedAvatarRenderer, patchedDir, patchedGrammars, patchedLocalizedStrings, patchedSelectVoice, patchedStyleSet, patchedToastRenderer, patchedTypingIndicatorRenderer, renderMarkdown, sendBoxFocusRef, sendTypingIndicator, setDictateAbortable, styleOptions, suggestedActionsAccessKey, telemetryDimensionsRef, trackDimension, transcriptActivityElementsRef, transcriptFocusRef, transcriptRootElementRef, userID, username, webSpeechPonyfill]);
  return /*#__PURE__*/_react.default.createElement(_WebChatUIContext.default.Provider, {
    value: context
  }, /*#__PURE__*/_react.default.createElement(_reactSay.Composer, {
    ponyfill: webSpeechPonyfill
  }, typeof children === 'function' ? children(context) : children), /*#__PURE__*/_react.default.createElement(_Dictation.default, {
    onError: dictationOnError
  }), onTelemetry && /*#__PURE__*/_react.default.createElement(_Tracker.default, null));
}; // We will create a Redux store if it was not passed in


var ComposeWithStore = function ComposeWithStore(_ref11) {
  var onTelemetry = _ref11.onTelemetry,
      store = _ref11.store,
      props = _objectWithoutProperties(_ref11, ["onTelemetry", "store"]);

  var handleError = (0, _react.useCallback)(function (_ref12) {
    var error = _ref12.error;
    onTelemetry && onTelemetry((0, _createCustomEvent.default)('exception', {
      error: error,
      fatal: true
    }));
  }, [onTelemetry]);
  var memoizedStore = (0, _react.useMemo)(function () {
    return store || (0, _botframeworkWebchatCore.createStore)();
  }, [store]);
  return /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, {
    onError: handleError
  }, /*#__PURE__*/_react.default.createElement(_reactRedux.Provider, {
    context: _WebChatReduxContext.default,
    store: memoizedStore
  }, /*#__PURE__*/_react.default.createElement(_reactScrollToBottom.Composer, null, /*#__PURE__*/_react.default.createElement(Composer, _extends({
    onTelemetry: onTelemetry
  }, props)))));
};

ComposeWithStore.defaultProps = {
  onTelemetry: undefined,
  store: undefined
};
ComposeWithStore.propTypes = {
  onTelemetry: _propTypes.default.func,
  store: _propTypes.default.any
};
var _default = ComposeWithStore; // TODO: [P3] We should consider moving some data from Redux store to props
//       Although we use `connectToWebChat` to hide the details of accessor of Redux store,
//       we should clean up the responsibility between Context and Redux store
//       We should decide which data is needed for React but not in other environment such as CLI/VSCode

exports.default = _default;
Composer.defaultProps = {
  activityMiddleware: undefined,
  activityRenderer: undefined,
  activityStatusMiddleware: undefined,
  activityStatusRenderer: undefined,
  attachmentMiddleware: undefined,
  attachmentRenderer: undefined,
  avatarMiddleware: undefined,
  avatarRenderer: undefined,
  cardActionMiddleware: undefined,
  children: undefined,
  dir: 'auto',
  disabled: false,
  extraStyleSet: undefined,
  grammars: [],
  groupActivitiesMiddleware: undefined,
  groupTimestamp: undefined,
  locale: window.navigator.language || 'en-US',
  onTelemetry: undefined,
  overrideLocalizedStrings: undefined,
  renderMarkdown: undefined,
  selectVoice: undefined,
  sendTimeout: undefined,
  sendTypingIndicator: false,
  styleOptions: {},
  styleSet: undefined,
  suggestedActionsAccessKey: 'A a Å å',
  toastMiddleware: undefined,
  toastRenderer: undefined,
  typingIndicatorMiddleware: undefined,
  typingIndicatorRenderer: undefined,
  userID: '',
  username: '',
  webSpeechPonyfillFactory: undefined
};
Composer.propTypes = {
  activityMiddleware: _propTypes.default.func,
  activityRenderer: _propTypes.default.func,
  activityStatusMiddleware: _propTypes.default.func,
  activityStatusRenderer: _propTypes.default.func,
  attachmentMiddleware: _propTypes.default.func,
  attachmentRenderer: _propTypes.default.func,
  avatarMiddleware: _propTypes.default.func,
  avatarRenderer: _propTypes.default.func,
  cardActionMiddleware: _propTypes.default.func,
  children: _propTypes.default.any,
  dir: _propTypes.default.oneOf(['auto', 'ltr', 'rtl']),
  directLine: _propTypes.default.shape({
    activity$: _propTypes.default.shape({
      subscribe: _propTypes.default.func.isRequired
    }).isRequired,
    connectionStatus$: _propTypes.default.shape({
      subscribe: _propTypes.default.func.isRequired
    }).isRequired,
    end: _propTypes.default.func,
    getSessionId: _propTypes.default.func,
    postActivity: _propTypes.default.func.isRequired,
    referenceGrammarID: _propTypes.default.string,
    token: _propTypes.default.string
  }).isRequired,
  disabled: _propTypes.default.bool,
  extraStyleSet: _propTypes.default.any,
  grammars: _propTypes.default.arrayOf(_propTypes.default.string),
  groupActivitiesMiddleware: _propTypes.default.func,
  groupTimestamp: _propTypes.default.oneOfType([_propTypes.default.bool, _propTypes.default.number]),
  locale: _propTypes.default.string,
  onTelemetry: _propTypes.default.func,
  overrideLocalizedStrings: _propTypes.default.oneOfType([_propTypes.default.any, _propTypes.default.func]),
  renderMarkdown: _propTypes.default.func,
  selectVoice: _propTypes.default.func,
  sendTimeout: _propTypes.default.number,
  sendTypingIndicator: _propTypes.default.bool,
  styleOptions: _propTypes.default.any,
  styleSet: _propTypes.default.any,
  suggestedActionsAccessKey: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.string]),
  toastMiddleware: _propTypes.default.func,
  toastRenderer: _propTypes.default.func,
  typingIndicatorMiddleware: _propTypes.default.func,
  typingIndicatorRenderer: _propTypes.default.func,
  userID: _propTypes.default.string,
  username: _propTypes.default.string,
  webSpeechPonyfillFactory: _propTypes.default.func
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9Db21wb3Nlci5qcyJdLCJuYW1lcyI6WyJESVNQQVRDSEVSUyIsImNsZWFyU3VnZ2VzdGVkQWN0aW9ucyIsImRpc21pc3NOb3RpZmljYXRpb24iLCJlbWl0VHlwaW5nSW5kaWNhdG9yIiwibWFya0FjdGl2aXR5IiwicG9zdEFjdGl2aXR5Iiwic2VuZEV2ZW50Iiwic2VuZEZpbGVzIiwic2VuZE1lc3NhZ2UiLCJzZW5kTWVzc2FnZUJhY2siLCJzZW5kUG9zdEJhY2siLCJzZXREaWN0YXRlSW50ZXJpbXMiLCJzZXREaWN0YXRlU3RhdGUiLCJzZXROb3RpZmljYXRpb24iLCJzZXRTZW5kQm94Iiwic2V0U2VuZFRpbWVvdXQiLCJzdGFydERpY3RhdGUiLCJzdGFydFNwZWFraW5nQWN0aXZpdHkiLCJzdG9wRGljdGF0ZSIsInN0b3BTcGVha2luZ0FjdGl2aXR5Iiwic3VibWl0U2VuZEJveCIsInN0eWxlU2V0VG9DbGFzc05hbWVzIiwic3R5bGVTZXQiLCJzdHlsZSIsImtleSIsImNyZWF0ZUNhcmRBY3Rpb25Db250ZXh0IiwiY2FyZEFjdGlvbk1pZGRsZXdhcmUiLCJkaXJlY3RMaW5lIiwiZGlzcGF0Y2giLCJydW5NaWRkbGV3YXJlIiwib25DYXJkQWN0aW9uIiwiY2FyZEFjdGlvbiIsInRhcmdldCIsInR5cGUiLCJFcnJvciIsImdldFNpZ25JblVybCIsInZhbHVlIiwiZ2V0U2Vzc2lvbklkIiwidGhlbiIsInNlc3Npb25JZCIsImVuY29kZVVSSUNvbXBvbmVudCIsImNvbnNvbGUiLCJ3YXJuIiwiY3JlYXRlRm9jdXNDb250ZXh0Iiwic2VuZEJveEZvY3VzUmVmIiwidHJhbnNjcmlwdEZvY3VzUmVmIiwiZm9jdXMiLCJ3aGVyZSIsInJlZiIsImN1cnJlbnQiLCJyZWFkT25seSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldFRpbWVvdXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjcmVhdGVHcm91cEFjdGl2aXRpZXNDb250ZXh0IiwiZ3JvdXBBY3Rpdml0aWVzTWlkZGxld2FyZSIsImdyb3VwVGltZXN0YW1wIiwiZ3JvdXBBY3Rpdml0aWVzIiwiYWN0aXZpdGllcyIsIm1lcmdlU3RyaW5nc092ZXJyaWRlcyIsImxvY2FsaXplZFN0cmluZ3MiLCJsYW5ndWFnZSIsIm92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyIsIm1lcmdlZCIsIkNvbXBvc2VyIiwiYWN0aXZpdHlNaWRkbGV3YXJlIiwiYWN0aXZpdHlSZW5kZXJlciIsImFjdGl2aXR5U3RhdHVzTWlkZGxld2FyZSIsImFjdGl2aXR5U3RhdHVzUmVuZGVyZXIiLCJhdHRhY2htZW50TWlkZGxld2FyZSIsImF0dGFjaG1lbnRSZW5kZXJlciIsImF2YXRhck1pZGRsZXdhcmUiLCJhdmF0YXJSZW5kZXJlciIsImNoaWxkcmVuIiwiZGlyIiwiZGlzYWJsZWQiLCJleHRyYVN0eWxlU2V0IiwiZ3JhbW1hcnMiLCJsb2NhbGUiLCJvblRlbGVtZXRyeSIsInJlbmRlck1hcmtkb3duIiwic2VsZWN0Vm9pY2UiLCJzZW5kVGltZW91dCIsInNlbmRUeXBpbmdJbmRpY2F0b3IiLCJzdHlsZU9wdGlvbnMiLCJzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5IiwidG9hc3RNaWRkbGV3YXJlIiwidG9hc3RSZW5kZXJlciIsInR5cGluZ0luZGljYXRvck1pZGRsZXdhcmUiLCJ0eXBpbmdJbmRpY2F0b3JSZW5kZXJlciIsInVzZXJJRCIsInVzZXJuYW1lIiwid2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5IiwiZGljdGF0ZUFib3J0YWJsZSIsInNldERpY3RhdGVBYm9ydGFibGUiLCJyZWZlcmVuY2VHcmFtbWFySUQiLCJ0ZWxlbWV0cnlEaW1lbnNpb25zUmVmIiwicGF0Y2hlZERpciIsInBhdGNoZWRHcmFtbWFycyIsInBhdGNoZWRTdHlsZU9wdGlvbnMiLCJzbG93Q29ubmVjdGlvbkFmdGVyIiwiaW50ZXJuYWxNYXJrZG93bkl0IiwiTWFya2Rvd25JdCIsImludGVybmFsUmVuZGVyTWFya2Rvd25JbmxpbmUiLCJtYXJrZG93biIsInRyZWUiLCJwYXJzZUlubGluZSIsInBhdGNoZWRUcmVlIiwicmVuZGVyZXIiLCJyZW5kZXIiLCJjYXJkQWN0aW9uQ29udGV4dCIsInBhdGNoZWRTZWxlY3RWb2ljZSIsImRlZmF1bHRTZWxlY3RWb2ljZSIsImJpbmQiLCJmb2N1c0NvbnRleHQiLCJwYXRjaGVkU3R5bGVTZXQiLCJncm91cEFjdGl2aXRpZXNDb250ZXh0Iiwib3B0aW9ucyIsImhvaXN0ZWREaXNwYXRjaGVycyIsImRpc3BhdGNoZXIiLCJ3ZWJTcGVlY2hQb255ZmlsbCIsInBvbnlmaWxsIiwic3BlZWNoU3ludGhlc2lzIiwiU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIiwiYnlwYXNzU3BlZWNoU3ludGhlc2lzIiwiQnlwYXNzU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIiwiZGljdGF0aW9uT25FcnJvciIsImVyciIsImVycm9yIiwicGF0Y2hlZExvY2FsaXplZFN0cmluZ3MiLCJsb2NhbGl6ZWRHbG9iYWxpemUiLCJHTE9CQUxJWkUiLCJHTE9CQUxJWkVfTEFOR1VBR0UiLCJ0cmFja0RpbWVuc2lvbiIsIm5hbWUiLCJkYXRhIiwicGF0Y2hlZEFjdGl2aXR5UmVuZGVyZXIiLCJwYXRjaGVkQWN0aXZpdHlTdGF0dXNSZW5kZXJlciIsInBhdGNoZWRBdHRhY2htZW50UmVuZGVyZXIiLCJwYXRjaGVkQXZhdGFyUmVuZGVyZXIiLCJwYXRjaGVkVG9hc3RSZW5kZXJlciIsInBhdGNoZWRUeXBpbmdJbmRpY2F0b3JSZW5kZXJlciIsInRyYW5zY3JpcHRBY3Rpdml0eUVsZW1lbnRzUmVmIiwidHJhbnNjcmlwdFJvb3RFbGVtZW50UmVmIiwiY29udGV4dCIsImludGVybmFsTWFya2Rvd25JdFN0YXRlIiwibG9jYWxpemVkR2xvYmFsaXplU3RhdGUiLCJDb21wb3NlV2l0aFN0b3JlIiwic3RvcmUiLCJwcm9wcyIsImhhbmRsZUVycm9yIiwiZmF0YWwiLCJtZW1vaXplZFN0b3JlIiwiV2ViQ2hhdFJlZHV4Q29udGV4dCIsImRlZmF1bHRQcm9wcyIsInVuZGVmaW5lZCIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsImZ1bmMiLCJhbnkiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJvbmVPZiIsInNoYXBlIiwiYWN0aXZpdHkkIiwic3Vic2NyaWJlIiwiaXNSZXF1aXJlZCIsImNvbm5lY3Rpb25TdGF0dXMkIiwiZW5kIiwic3RyaW5nIiwidG9rZW4iLCJib29sIiwiYXJyYXlPZiIsIm9uZU9mVHlwZSIsIm51bWJlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQTRCQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUtBO0FBQ0EsSUFBTUEsV0FBVyxHQUFHO0FBQ2xCQyxFQUFBQSxxQkFBcUIsRUFBckJBLDhDQURrQjtBQUVsQkMsRUFBQUEsbUJBQW1CLEVBQW5CQSw0Q0FGa0I7QUFHbEJDLEVBQUFBLG1CQUFtQixFQUFuQkEsNENBSGtCO0FBSWxCQyxFQUFBQSxZQUFZLEVBQVpBLHFDQUprQjtBQUtsQkMsRUFBQUEsWUFBWSxFQUFaQSxxQ0FMa0I7QUFNbEJDLEVBQUFBLFNBQVMsRUFBVEEsa0NBTmtCO0FBT2xCQyxFQUFBQSxTQUFTLEVBQVRBLGtDQVBrQjtBQVFsQkMsRUFBQUEsV0FBVyxFQUFYQSxvQ0FSa0I7QUFTbEJDLEVBQUFBLGVBQWUsRUFBZkEsd0NBVGtCO0FBVWxCQyxFQUFBQSxZQUFZLEVBQVpBLHFDQVZrQjtBQVdsQkMsRUFBQUEsa0JBQWtCLEVBQWxCQSwyQ0FYa0I7QUFZbEJDLEVBQUFBLGVBQWUsRUFBZkEsd0NBWmtCO0FBYWxCQyxFQUFBQSxlQUFl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bXBvcnQgeyBDb21wb3NlciBhcyBTYXlDb21wb3NlciB9IGZyb20gJ3JlYWN0LXNheSc7XG5pbXBvcnQgeyBDb21wb3NlciBhcyBTY3JvbGxUb0JvdHRvbUNvbXBvc2VyIH0gZnJvbSAncmVhY3Qtc2Nyb2xsLXRvLWJvdHRvbSc7XG5cbmltcG9ydCB7IGNzcyB9IGZyb20gJ2dsYW1vcic7XG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCBNYXJrZG93bkl0IGZyb20gJ21hcmtkb3duLWl0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB1cGRhdGVJbiBmcm9tICdzaW1wbGUtdXBkYXRlLWluJztcblxuaW1wb3J0IGNyZWF0ZUFjdGl2aXR5UmVuZGVyZXIgZnJvbSAnLi9NaWRkbGV3YXJlL2NyZWF0ZUFjdGl2aXR5UmVuZGVyZXInO1xuaW1wb3J0IGNyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXIgZnJvbSAnLi9NaWRkbGV3YXJlL2NyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXInO1xuaW1wb3J0IGNyZWF0ZUF0dGFjaG1lbnRSZW5kZXJlciBmcm9tICcuL01pZGRsZXdhcmUvY3JlYXRlQXR0YWNobWVudFJlbmRlcmVyJztcbmltcG9ydCBjcmVhdGVBdmF0YXJSZW5kZXJlciBmcm9tICcuL01pZGRsZXdhcmUvY3JlYXRlQXZhdGFyUmVuZGVyZXInO1xuaW1wb3J0IGNyZWF0ZUN1c3RvbUV2ZW50IGZyb20gJy4vVXRpbHMvY3JlYXRlQ3VzdG9tRXZlbnQnO1xuaW1wb3J0IGNyZWF0ZVRvYXN0UmVuZGVyZXIgZnJvbSAnLi9NaWRkbGV3YXJlL2NyZWF0ZVRvYXN0UmVuZGVyZXInO1xuaW1wb3J0IGNyZWF0ZVR5cGluZ0luZGljYXRvclJlbmRlcmVyIGZyb20gJy4vTWlkZGxld2FyZS9jcmVhdGVUeXBpbmdJbmRpY2F0b3JSZW5kZXJlcic7XG5pbXBvcnQgRXJyb3JCb3VuZGFyeSBmcm9tICcuL0Vycm9yQm91bmRhcnknO1xuaW1wb3J0IGdldEFsbExvY2FsaXplZFN0cmluZ3MgZnJvbSAnLi9Mb2NhbGl6YXRpb24vZ2V0QWxsTG9jYWxpemVkU3RyaW5ncyc7XG5pbXBvcnQgaXNPYmplY3QgZnJvbSAnLi9VdGlscy9pc09iamVjdCc7XG5pbXBvcnQgbm9ybWFsaXplTGFuZ3VhZ2UgZnJvbSAnLi9VdGlscy9ub3JtYWxpemVMYW5ndWFnZSc7XG5pbXBvcnQgUHJlY29tcGlsZWRHbG9iYWxpemUgZnJvbSAnLi9VdGlscy9QcmVjb21waWxlZEdsb2JhbGl6ZSc7XG5pbXBvcnQgdXNlUmVmZXJlbmNlR3JhbW1hcklEIGZyb20gJy4vaG9va3MvdXNlUmVmZXJlbmNlR3JhbW1hcklEJztcblxuaW1wb3J0IHtcbiAgY2xlYXJTdWdnZXN0ZWRBY3Rpb25zLFxuICBjb25uZWN0IGFzIGNyZWF0ZUNvbm5lY3RBY3Rpb24sXG4gIGNyZWF0ZVN0b3JlLFxuICBkaXNjb25uZWN0LFxuICBkaXNtaXNzTm90aWZpY2F0aW9uLFxuICBlbWl0VHlwaW5nSW5kaWNhdG9yLFxuICBtYXJrQWN0aXZpdHksXG4gIHBvc3RBY3Rpdml0eSxcbiAgc2VuZEV2ZW50LFxuICBzZW5kRmlsZXMsXG4gIHNlbmRNZXNzYWdlLFxuICBzZW5kTWVzc2FnZUJhY2ssXG4gIHNlbmRQb3N0QmFjayxcbiAgc2V0RGljdGF0ZUludGVyaW1zLFxuICBzZXREaWN0YXRlU3RhdGUsXG4gIHNldExhbmd1YWdlLFxuICBzZXROb3RpZmljYXRpb24sXG4gIHNldFNlbmRCb3gsXG4gIHNldFNlbmRUaW1lb3V0LFxuICBzZXRTZW5kVHlwaW5nSW5kaWNhdG9yLFxuICBzdGFydERpY3RhdGUsXG4gIHN0YXJ0U3BlYWtpbmdBY3Rpdml0eSxcbiAgc3RvcERpY3RhdGUsXG4gIHN0b3BTcGVha2luZ0FjdGl2aXR5LFxuICBzdWJtaXRTZW5kQm94XG59IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWNvcmUnO1xuXG5pbXBvcnQgYWRkVGFyZ2V0QmxhbmtUb0h5cGVybGlua3NNYXJrZG93biBmcm9tICcuL1V0aWxzL2FkZFRhcmdldEJsYW5rVG9IeXBlcmxpbmtzTWFya2Rvd24nO1xuaW1wb3J0IGNvbmNhdE1pZGRsZXdhcmUgZnJvbSAnLi9NaWRkbGV3YXJlL2NvbmNhdE1pZGRsZXdhcmUnO1xuaW1wb3J0IGNyZWF0ZUNvcmVDYXJkQWN0aW9uTWlkZGxld2FyZSBmcm9tICcuL01pZGRsZXdhcmUvQ2FyZEFjdGlvbi9jcmVhdGVDb3JlTWlkZGxld2FyZSc7XG5pbXBvcnQgY3JlYXRlRGVmYXVsdEdyb3VwQWN0aXZpdGllc01pZGRsZXdhcmUgZnJvbSAnLi9NaWRkbGV3YXJlL0dyb3VwQWN0aXZpdGllcy9jcmVhdGVDb3JlTWlkZGxld2FyZSc7XG5pbXBvcnQgY3JlYXRlU3R5bGVTZXQgZnJvbSAnLi9TdHlsZXMvY3JlYXRlU3R5bGVTZXQnO1xuaW1wb3J0IGRlZmF1bHRTZWxlY3RWb2ljZSBmcm9tICcuL2RlZmF1bHRTZWxlY3RWb2ljZSc7XG5pbXBvcnQgRGljdGF0aW9uIGZyb20gJy4vRGljdGF0aW9uJztcbmltcG9ydCBtYXBNYXAgZnJvbSAnLi9VdGlscy9tYXBNYXAnO1xuaW1wb3J0IG9ic2VydmFibGVUb1Byb21pc2UgZnJvbSAnLi9VdGlscy9vYnNlcnZhYmxlVG9Qcm9taXNlJztcbmltcG9ydCBUcmFja2VyIGZyb20gJy4vVHJhY2tlcic7XG5pbXBvcnQgV2ViQ2hhdFJlZHV4Q29udGV4dCwgeyB1c2VEaXNwYXRjaCB9IGZyb20gJy4vV2ViQ2hhdFJlZHV4Q29udGV4dCc7XG5pbXBvcnQgV2ViQ2hhdFVJQ29udGV4dCBmcm9tICcuL1dlYkNoYXRVSUNvbnRleHQnO1xuXG5pbXBvcnQge1xuICBzcGVlY2hTeW50aGVzaXMgYXMgYnlwYXNzU3BlZWNoU3ludGhlc2lzLFxuICBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UgYXMgQnlwYXNzU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlXG59IGZyb20gJy4vU3BlZWNoL0J5cGFzc1NwZWVjaFN5bnRoZXNpc1BvbnlmaWxsJztcblxuLy8gTGlzdCBvZiBSZWR1eCBhY3Rpb25zIGZhY3Rvcnkgd2UgYXJlIGhvaXN0aW5nIGFzIFdlYiBDaGF0IGZ1bmN0aW9uc1xuY29uc3QgRElTUEFUQ0hFUlMgPSB7XG4gIGNsZWFyU3VnZ2VzdGVkQWN0aW9ucyxcbiAgZGlzbWlzc05vdGlmaWNhdGlvbixcbiAgZW1pdFR5cGluZ0luZGljYXRvcixcbiAgbWFya0FjdGl2aXR5LFxuICBwb3N0QWN0aXZpdHksXG4gIHNlbmRFdmVudCxcbiAgc2VuZEZpbGVzLFxuICBzZW5kTWVzc2FnZSxcbiAgc2VuZE1lc3NhZ2VCYWNrLFxuICBzZW5kUG9zdEJhY2ssXG4gIHNldERpY3RhdGVJbnRlcmltcyxcbiAgc2V0RGljdGF0ZVN0YXRlLFxuICBzZXROb3RpZmljYXRpb24sXG4gIHNldFNlbmRCb3gsXG4gIHNldFNlbmRUaW1lb3V0LFxuICBzdGFydERpY3RhdGUsXG4gIHN0YXJ0U3BlYWtpbmdBY3Rpdml0eSxcbiAgc3RvcERpY3RhdGUsXG4gIHN0b3BTcGVha2luZ0FjdGl2aXR5LFxuICBzdWJtaXRTZW5kQm94XG59O1xuXG5mdW5jdGlvbiBzdHlsZVNldFRvQ2xhc3NOYW1lcyhzdHlsZVNldCkge1xuICByZXR1cm4gbWFwTWFwKHN0eWxlU2V0LCAoc3R5bGUsIGtleSkgPT4gKGtleSA9PT0gJ29wdGlvbnMnID8gc3R5bGUgOiBjc3Moc3R5bGUpKSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmRBY3Rpb25Db250ZXh0KHsgY2FyZEFjdGlvbk1pZGRsZXdhcmUsIGRpcmVjdExpbmUsIGRpc3BhdGNoIH0pIHtcbiAgY29uc3QgcnVuTWlkZGxld2FyZSA9IGNvbmNhdE1pZGRsZXdhcmUoY2FyZEFjdGlvbk1pZGRsZXdhcmUsIGNyZWF0ZUNvcmVDYXJkQWN0aW9uTWlkZGxld2FyZSgpKSh7IGRpc3BhdGNoIH0pO1xuXG4gIHJldHVybiB7XG4gICAgb25DYXJkQWN0aW9uOiAoY2FyZEFjdGlvbiwgeyB0YXJnZXQgfSA9IHt9KSA9PlxuICAgICAgcnVuTWlkZGxld2FyZSgoeyBjYXJkQWN0aW9uOiB7IHR5cGUgfSB9KSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgV2ViIENoYXQ6IHJlY2VpdmVkIHVua25vd24gY2FyZCBhY3Rpb24gXCIke3R5cGV9XCJgKTtcbiAgICAgIH0pKHtcbiAgICAgICAgY2FyZEFjdGlvbixcbiAgICAgICAgZ2V0U2lnbkluVXJsOlxuICAgICAgICAgIGNhcmRBY3Rpb24udHlwZSA9PT0gJ3NpZ25pbidcbiAgICAgICAgICAgID8gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IGNhcmRBY3Rpb247XG5cbiAgICAgICAgICAgICAgICBpZiAoZGlyZWN0TGluZS5nZXRTZXNzaW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFtQM10gV2Ugc2hvdWxkIGNoYW5nZSB0aGlzIG9uZSB0byBhc3luYy9hd2FpdC5cbiAgICAgICAgICAgICAgICAgIC8vICAgICAgIFRoaXMgaXMgdGhlIGZpcnN0IHBsYWNlIGluIHRoaXMgcHJvamVjdCB0byB1c2UgYXN5bmMuXG4gICAgICAgICAgICAgICAgICAvLyAgICAgICBUaHVzLCB3ZSBuZWVkIHRvIGFkZCBAYmFiZWwvcGx1Z2luLXRyYW5zZm9ybS1ydW50aW1lIGFuZCBAYmFiZWwvcnVudGltZS5cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmFibGVUb1Byb21pc2UoZGlyZWN0TGluZS5nZXRTZXNzaW9uSWQoKSkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbklkID0+IGAke3ZhbHVlfSR7ZW5jb2RlVVJJQ29tcG9uZW50KGAmY29kZV9jaGFsbGVuZ2U9JHtzZXNzaW9uSWR9YCl9YFxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ2JvdGZyYW1ld29yay13ZWJjaGF0OiBPQXV0aCBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgRGlyZWN0IExpbmUgYWRhcHRlci4nKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICB0YXJnZXRcbiAgICAgIH0pXG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZvY3VzQ29udGV4dCh7IHNlbmRCb3hGb2N1c1JlZiwgdHJhbnNjcmlwdEZvY3VzUmVmIH0pIHtcbiAgcmV0dXJuIHtcbiAgICBmb2N1czogd2hlcmUgPT4ge1xuICAgICAgY29uc3QgcmVmID0gd2hlcmUgPT09ICdzZW5kQm94JyB8fCB3aGVyZSA9PT0gJ3NlbmRCb3hXaXRob3V0S2V5Ym9hcmQnID8gc2VuZEJveEZvY3VzUmVmIDogdHJhbnNjcmlwdEZvY3VzUmVmO1xuICAgICAgY29uc3QgeyBjdXJyZW50IH0gPSByZWYgfHwge307XG5cbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGlmICh3aGVyZSA9PT0gJ3NlbmRCb3hXaXRob3V0S2V5Ym9hcmQnKSB7XG4gICAgICAgICAgLy8gVG8gbm90IGFjdGl2YXRlIHRoZSB2aXJ0dWFsIGtleWJvYXJkIHdoaWxlIGNoYW5naW5nIGZvY3VzIHRvIGFuIGlucHV0LCB3ZSB3aWxsIHRlbXBvcmFyaWx5IHNldCBpdCBhcyByZWFkLW9ubHkgYW5kIGZsaXAgaXQgYmFjay5cbiAgICAgICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83NjEwNzU4L3ByZXZlbnQtaXBob25lLWRlZmF1bHQta2V5Ym9hcmQtd2hlbi1mb2N1c2luZy1hbi1pbnB1dC83NjEwOTIzXG4gICAgICAgICAgY29uc3QgcmVhZE9ubHkgPSBjdXJyZW50LmdldEF0dHJpYnV0ZSgncmVhZG9ubHknKTtcblxuICAgICAgICAgIGN1cnJlbnQuc2V0QXR0cmlidXRlKCdyZWFkb25seScsICdyZWFkb25seScpO1xuXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjdXJyZW50LmZvY3VzKCk7XG4gICAgICAgICAgICByZWFkT25seSA/IGN1cnJlbnQuc2V0QXR0cmlidXRlKCdyZWFkb25seScsIHJlYWRPbmx5KSA6IGN1cnJlbnQucmVtb3ZlQXR0cmlidXRlKCdyZWFkb25seScpO1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlR3JvdXBBY3Rpdml0aWVzQ29udGV4dCh7IGdyb3VwQWN0aXZpdGllc01pZGRsZXdhcmUsIGdyb3VwVGltZXN0YW1wIH0pIHtcbiAgY29uc3QgcnVuTWlkZGxld2FyZSA9IGNvbmNhdE1pZGRsZXdhcmUoXG4gICAgZ3JvdXBBY3Rpdml0aWVzTWlkZGxld2FyZSxcbiAgICBjcmVhdGVEZWZhdWx0R3JvdXBBY3Rpdml0aWVzTWlkZGxld2FyZSh7IGdyb3VwVGltZXN0YW1wIH0pXG4gICkoKSgoKSA9PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdib3RmcmFtZXdvcmstd2ViY2hhdCBpbnRlcm5hbDogTm8gbWlkZGxld2FyZSBpcyBleGVjdXRlIGZvciBncm91cEFjdGl2aXRpZXMuJyk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgZ3JvdXBBY3Rpdml0aWVzOiAoeyBhY3Rpdml0aWVzIH0pID0+IHJ1bk1pZGRsZXdhcmUoeyBhY3Rpdml0aWVzIH0pXG4gIH07XG59XG5cbmZ1bmN0aW9uIG1lcmdlU3RyaW5nc092ZXJyaWRlcyhsb2NhbGl6ZWRTdHJpbmdzLCBsYW5ndWFnZSwgb3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzKSB7XG4gIGlmICghb3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzKSB7XG4gICAgcmV0dXJuIGxvY2FsaXplZFN0cmluZ3M7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNvbnN0IG1lcmdlZCA9IG92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyhsb2NhbGl6ZWRTdHJpbmdzLCBsYW5ndWFnZSk7XG5cbiAgICBpZiAoIWlzT2JqZWN0KG1lcmdlZCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IG92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyBmdW5jdGlvbiBtdXN0IHJldHVybiBhbiBvYmplY3QuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1lcmdlZDtcbiAgfVxuXG4gIGlmICghaXNPYmplY3Qob3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IG92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyBtdXN0IGJlIGVpdGhlciBhIGZ1bmN0aW9uLCBhbiBvYmplY3QsIG9yIGZhbHN5LicpO1xuICB9XG5cbiAgcmV0dXJuIHsgLi4ubG9jYWxpemVkU3RyaW5ncywgLi4ub3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzIH07XG59XG5cbmNvbnN0IENvbXBvc2VyID0gKHtcbiAgYWN0aXZpdHlNaWRkbGV3YXJlLFxuICBhY3Rpdml0eVJlbmRlcmVyLFxuICBhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmUsXG4gIGFjdGl2aXR5U3RhdHVzUmVuZGVyZXIsXG4gIGF0dGFjaG1lbnRNaWRkbGV3YXJlLFxuICBhdHRhY2htZW50UmVuZGVyZXIsXG4gIGF2YXRhck1pZGRsZXdhcmUsXG4gIGF2YXRhclJlbmRlcmVyLFxuICBjYXJkQWN0aW9uTWlkZGxld2FyZSxcbiAgY2hpbGRyZW4sXG4gIGRpcixcbiAgZGlyZWN0TGluZSxcbiAgZGlzYWJsZWQsXG4gIGV4dHJhU3R5bGVTZXQsXG4gIGdyYW1tYXJzLFxuICBncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlLFxuICBncm91cFRpbWVzdGFtcCxcbiAgbG9jYWxlLFxuICBvblRlbGVtZXRyeSxcbiAgb3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzLFxuICByZW5kZXJNYXJrZG93bixcbiAgc2VsZWN0Vm9pY2UsXG4gIHNlbmRUaW1lb3V0LFxuICBzZW5kVHlwaW5nSW5kaWNhdG9yLFxuICBzdHlsZU9wdGlvbnMsXG4gIHN0eWxlU2V0LFxuICBzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5LFxuICB0b2FzdE1pZGRsZXdhcmUsXG4gIHRvYXN0UmVuZGVyZXIsXG4gIHR5cGluZ0luZGljYXRvck1pZGRsZXdhcmUsXG4gIHR5cGluZ0luZGljYXRvclJlbmRlcmVyLFxuICB1c2VySUQsXG4gIHVzZXJuYW1lLFxuICB3ZWJTcGVlY2hQb255ZmlsbEZhY3Rvcnlcbn0pID0+IHtcbiAgY29uc3QgW2RpY3RhdGVBYm9ydGFibGUsIHNldERpY3RhdGVBYm9ydGFibGVdID0gdXNlU3RhdGUoKTtcbiAgY29uc3QgW3JlZmVyZW5jZUdyYW1tYXJJRF0gPSB1c2VSZWZlcmVuY2VHcmFtbWFySUQoKTtcbiAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xuICBjb25zdCBzZW5kQm94Rm9jdXNSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgdGVsZW1ldHJ5RGltZW5zaW9uc1JlZiA9IHVzZVJlZih7fSk7XG4gIGNvbnN0IHRyYW5zY3JpcHRGb2N1c1JlZiA9IHVzZVJlZigpO1xuXG4gIGNvbnN0IHBhdGNoZWREaXIgPSB1c2VNZW1vKCgpID0+IChkaXIgPT09ICdsdHInIHx8IGRpciA9PT0gJ3J0bCcgPyBkaXIgOiAnYXV0bycpLCBbZGlyXSk7XG4gIGNvbnN0IHBhdGNoZWRHcmFtbWFycyA9IHVzZU1lbW8oKCkgPT4gZ3JhbW1hcnMgfHwgW10sIFtncmFtbWFyc10pO1xuXG4gIGNvbnN0IHBhdGNoZWRTdHlsZU9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBwYXRjaGVkU3R5bGVPcHRpb25zID0geyAuLi5zdHlsZU9wdGlvbnMgfTtcblxuICAgIGlmICh0eXBlb2YgZ3JvdXBUaW1lc3RhbXAgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwYXRjaGVkU3R5bGVPcHRpb25zLmdyb3VwVGltZXN0YW1wID09PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnV2ViIENoYXQ6IFwiZ3JvdXBUaW1lc3RhbXBcIiBoYXMgYmVlbiBtb3ZlZCB0byBcInN0eWxlT3B0aW9uc1wiLiBUaGlzIGRlcHJlY2F0aW9uIG1pZ3JhdGlvbiB3aWxsIGJlIHJlbW92ZWQgb24gb3IgYWZ0ZXIgSmFudWFyeSAxIDIwMjIuJ1xuICAgICAgKTtcblxuICAgICAgcGF0Y2hlZFN0eWxlT3B0aW9ucy5ncm91cFRpbWVzdGFtcCA9IGdyb3VwVGltZXN0YW1wO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygc2VuZFRpbWVvdXQgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwYXRjaGVkU3R5bGVPcHRpb25zLnNlbmRUaW1lb3V0ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnV2ViIENoYXQ6IFwic2VuZFRpbWVvdXRcIiBoYXMgYmVlbiBtb3ZlZCB0byBcInN0eWxlT3B0aW9uc1wiLiBUaGlzIGRlcHJlY2F0aW9uIG1pZ3JhdGlvbiB3aWxsIGJlIHJlbW92ZWQgb24gb3IgYWZ0ZXIgSmFudWFyeSAxIDIwMjIuJ1xuICAgICAgKTtcblxuICAgICAgcGF0Y2hlZFN0eWxlT3B0aW9ucy5zZW5kVGltZW91dCA9IHNlbmRUaW1lb3V0O1xuICAgIH1cblxuICAgIGlmIChzdHlsZU9wdGlvbnMuc2xvd0Nvbm5lY3Rpb25BZnRlciA8IDApIHtcbiAgICAgIGNvbnNvbGUud2FybignV2ViIENoYXQ6IFwic2xvd0Nvbm5lY3Rpb25BZnRlclwiIGNhbm5vdCBiZSBuZWdhdGl2ZSwgd2lsbCBzZXQgdG8gMC4nKTtcblxuICAgICAgcGF0Y2hlZFN0eWxlT3B0aW9ucy5zbG93Q29ubmVjdGlvbkFmdGVyID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gcGF0Y2hlZFN0eWxlT3B0aW9ucztcbiAgfSwgW2dyb3VwVGltZXN0YW1wLCBzZW5kVGltZW91dCwgc3R5bGVPcHRpb25zXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkaXNwYXRjaChzZXRMYW5ndWFnZShsb2NhbGUpKTtcbiAgfSwgW2Rpc3BhdGNoLCBsb2NhbGVdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHR5cGVvZiBzZW5kVGltZW91dCA9PT0gJ251bWJlcicgJiYgZGlzcGF0Y2goc2V0U2VuZFRpbWVvdXQoc2VuZFRpbWVvdXQpKTtcbiAgfSwgW2Rpc3BhdGNoLCBzZW5kVGltZW91dF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZGlzcGF0Y2goc2V0U2VuZFR5cGluZ0luZGljYXRvcighIXNlbmRUeXBpbmdJbmRpY2F0b3IpKTtcbiAgfSwgW2Rpc3BhdGNoLCBzZW5kVHlwaW5nSW5kaWNhdG9yXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkaXNwYXRjaChcbiAgICAgIGNyZWF0ZUNvbm5lY3RBY3Rpb24oe1xuICAgICAgICBkaXJlY3RMaW5lLFxuICAgICAgICB1c2VySUQsXG4gICAgICAgIHVzZXJuYW1lXG4gICAgICB9KVxuICAgICk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgLy8gVE9ETzogW1AzXSBkaXNjb25uZWN0KCkgaXMgYW4gYXN5bmMgY2FsbCAocGVuZGluZyAtPiBmdWxmaWxsZWQpLCB3ZSBuZWVkIHRvIHdhaXQsIG9yIGNoYW5nZSBpdCB0byByZWNvbm5lY3QoKVxuICAgICAgZGlzcGF0Y2goZGlzY29ubmVjdCgpKTtcbiAgICB9O1xuICB9LCBbZGlzcGF0Y2gsIGRpcmVjdExpbmUsIHVzZXJJRCwgdXNlcm5hbWVdKTtcblxuICBjb25zdCBpbnRlcm5hbE1hcmtkb3duSXQgPSB1c2VNZW1vKCgpID0+IG5ldyBNYXJrZG93bkl0KCksIFtdKTtcblxuICBjb25zdCBpbnRlcm5hbFJlbmRlck1hcmtkb3duSW5saW5lID0gdXNlTWVtbyhcbiAgICAoKSA9PiBtYXJrZG93biA9PiB7XG4gICAgICBjb25zdCB0cmVlID0gaW50ZXJuYWxNYXJrZG93bkl0LnBhcnNlSW5saW5lKG1hcmtkb3duKTtcblxuICAgICAgLy8gV2Ugc2hvdWxkIGFkZCByZWw9XCJub29wZW5lciBub3JlZmVycmVyXCIgYW5kIHRhcmdldD1cIl9ibGFua1wiXG4gICAgICBjb25zdCBwYXRjaGVkVHJlZSA9IGFkZFRhcmdldEJsYW5rVG9IeXBlcmxpbmtzTWFya2Rvd24odHJlZSk7XG5cbiAgICAgIHJldHVybiBpbnRlcm5hbE1hcmtkb3duSXQucmVuZGVyZXIucmVuZGVyKHBhdGNoZWRUcmVlKTtcbiAgICB9LFxuICAgIFtpbnRlcm5hbE1hcmtkb3duSXRdXG4gICk7XG5cbiAgY29uc3QgY2FyZEFjdGlvbkNvbnRleHQgPSB1c2VNZW1vKCgpID0+IGNyZWF0ZUNhcmRBY3Rpb25Db250ZXh0KHsgY2FyZEFjdGlvbk1pZGRsZXdhcmUsIGRpcmVjdExpbmUsIGRpc3BhdGNoIH0pLCBbXG4gICAgY2FyZEFjdGlvbk1pZGRsZXdhcmUsXG4gICAgZGlyZWN0TGluZSxcbiAgICBkaXNwYXRjaFxuICBdKTtcblxuICBjb25zdCBwYXRjaGVkU2VsZWN0Vm9pY2UgPSB1c2VDYWxsYmFjayhzZWxlY3RWb2ljZSB8fCBkZWZhdWx0U2VsZWN0Vm9pY2UuYmluZChudWxsLCB7IGxhbmd1YWdlOiBsb2NhbGUgfSksIFtcbiAgICBzZWxlY3RWb2ljZVxuICBdKTtcblxuICBjb25zdCBmb2N1c0NvbnRleHQgPSB1c2VNZW1vKCgpID0+IGNyZWF0ZUZvY3VzQ29udGV4dCh7IHNlbmRCb3hGb2N1c1JlZiwgdHJhbnNjcmlwdEZvY3VzUmVmIH0pLCBbXG4gICAgc2VuZEJveEZvY3VzUmVmLFxuICAgIHRyYW5zY3JpcHRGb2N1c1JlZlxuICBdKTtcblxuICBjb25zdCBwYXRjaGVkU3R5bGVTZXQgPSB1c2VNZW1vKFxuICAgICgpID0+IHN0eWxlU2V0VG9DbGFzc05hbWVzKHsgLi4uKHN0eWxlU2V0IHx8IGNyZWF0ZVN0eWxlU2V0KHBhdGNoZWRTdHlsZU9wdGlvbnMpKSwgLi4uZXh0cmFTdHlsZVNldCB9KSxcbiAgICBbZXh0cmFTdHlsZVNldCwgcGF0Y2hlZFN0eWxlT3B0aW9ucywgc3R5bGVTZXRdXG4gICk7XG5cbiAgY29uc3QgZ3JvdXBBY3Rpdml0aWVzQ29udGV4dCA9IHVzZU1lbW8oXG4gICAgKCkgPT5cbiAgICAgIGNyZWF0ZUdyb3VwQWN0aXZpdGllc0NvbnRleHQoe1xuICAgICAgICBncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlLFxuICAgICAgICBncm91cFRpbWVzdGFtcDogcGF0Y2hlZFN0eWxlU2V0Lm9wdGlvbnMuZ3JvdXBUaW1lc3RhbXBcbiAgICAgIH0pLFxuICAgIFtncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlLCBwYXRjaGVkU3R5bGVTZXQub3B0aW9ucy5ncm91cFRpbWVzdGFtcF1cbiAgKTtcblxuICBjb25zdCBob2lzdGVkRGlzcGF0Y2hlcnMgPSB1c2VNZW1vKFxuICAgICgpID0+IG1hcE1hcChESVNQQVRDSEVSUywgZGlzcGF0Y2hlciA9PiAoLi4uYXJncykgPT4gZGlzcGF0Y2goZGlzcGF0Y2hlciguLi5hcmdzKSkpLFxuICAgIFtkaXNwYXRjaF1cbiAgKTtcblxuICBjb25zdCB3ZWJTcGVlY2hQb255ZmlsbCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IHBvbnlmaWxsID0gd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5ICYmIHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeSh7IHJlZmVyZW5jZUdyYW1tYXJJRCB9KTtcbiAgICBjb25zdCB7IHNwZWVjaFN5bnRoZXNpcywgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIH0gPSBwb255ZmlsbCB8fCB7fTtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5wb255ZmlsbCxcbiAgICAgIHNwZWVjaFN5bnRoZXNpczogc3BlZWNoU3ludGhlc2lzIHx8IGJ5cGFzc1NwZWVjaFN5bnRoZXNpcyxcbiAgICAgIFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZTogU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIHx8IEJ5cGFzc1NwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZVxuICAgIH07XG4gIH0sIFtyZWZlcmVuY2VHcmFtbWFySUQsIHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeV0pO1xuXG4gIGNvbnN0IGRpY3RhdGlvbk9uRXJyb3IgPSB1c2VDYWxsYmFjayhlcnIgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHBhdGNoZWRMb2NhbGl6ZWRTdHJpbmdzID0gdXNlTWVtbyhcbiAgICAoKSA9PiBtZXJnZVN0cmluZ3NPdmVycmlkZXMoZ2V0QWxsTG9jYWxpemVkU3RyaW5ncygpW25vcm1hbGl6ZUxhbmd1YWdlKGxvY2FsZSldLCBsb2NhbGUsIG92ZXJyaWRlTG9jYWxpemVkU3RyaW5ncyksXG4gICAgW2xvY2FsZSwgb3ZlcnJpZGVMb2NhbGl6ZWRTdHJpbmdzXVxuICApO1xuXG4gIGNvbnN0IGxvY2FsaXplZEdsb2JhbGl6ZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IHsgR0xPQkFMSVpFLCBHTE9CQUxJWkVfTEFOR1VBR0UgfSA9IHBhdGNoZWRMb2NhbGl6ZWRTdHJpbmdzIHx8IHt9O1xuXG4gICAgcmV0dXJuIEdMT0JBTElaRSB8fCAoR0xPQkFMSVpFX0xBTkdVQUdFICYmIFByZWNvbXBpbGVkR2xvYmFsaXplKEdMT0JBTElaRV9MQU5HVUFHRSkpIHx8IFByZWNvbXBpbGVkR2xvYmFsaXplKCdlbicpO1xuICB9LCBbcGF0Y2hlZExvY2FsaXplZFN0cmluZ3NdKTtcblxuICBjb25zdCB0cmFja0RpbWVuc2lvbiA9IHVzZUNhbGxiYWNrKFxuICAgIChuYW1lLCBkYXRhKSA9PiB7XG4gICAgICBpZiAoIW5hbWUgfHwgdHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oJ2JvdGZyYW1ld29yay13ZWJjaGF0OiBUZWxlbWV0cnkgZGltZW5zaW9uIG5hbWUgbXVzdCBiZSBhIHN0cmluZy4nKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiBkYXRhO1xuXG4gICAgICBpZiAodHlwZSAhPT0gJ3N0cmluZycgJiYgdHlwZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGNvbnNvbGUud2FybignYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IFRlbGVtZXRyeSBkaW1lbnNpb24gZGF0YSBtdXN0IGJlIGEgc3RyaW5nIG9yIHVuZGVmaW5lZC4nKTtcbiAgICAgIH1cblxuICAgICAgdGVsZW1ldHJ5RGltZW5zaW9uc1JlZi5jdXJyZW50ID0gdXBkYXRlSW4oXG4gICAgICAgIHRlbGVtZXRyeURpbWVuc2lvbnNSZWYuY3VycmVudCxcbiAgICAgICAgW25hbWVdLFxuICAgICAgICB0eXBlID09PSAndW5kZWZpbmVkJyA/IGRhdGEgOiAoKSA9PiBkYXRhXG4gICAgICApO1xuICAgIH0sXG4gICAgW3RlbGVtZXRyeURpbWVuc2lvbnNSZWZdXG4gICk7XG5cbiAgY29uc3QgcGF0Y2hlZEFjdGl2aXR5UmVuZGVyZXIgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBhY3Rpdml0eVJlbmRlcmVyICYmXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdXZWIgQ2hhdDogXCJhY3Rpdml0eVJlbmRlcmVyXCIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIG9uIDIwMjAtMDYtMTUsIHBsZWFzZSB1c2UgXCJhY3Rpdml0eU1pZGRsZXdhcmVcIiBpbnN0ZWFkLidcbiAgICAgICk7XG5cbiAgICByZXR1cm4gYWN0aXZpdHlSZW5kZXJlciB8fCBjcmVhdGVBY3Rpdml0eVJlbmRlcmVyKGFjdGl2aXR5TWlkZGxld2FyZSk7XG4gIH0sIFthY3Rpdml0eU1pZGRsZXdhcmUsIGFjdGl2aXR5UmVuZGVyZXJdKTtcblxuICBjb25zdCBwYXRjaGVkQWN0aXZpdHlTdGF0dXNSZW5kZXJlciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGFjdGl2aXR5U3RhdHVzUmVuZGVyZXIgJiZcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ1dlYiBDaGF0OiBcImFjdGl2aXR5U3RhdHVzUmVuZGVyZXJcIiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgb24gMjAyMC0wNi0xNSwgcGxlYXNlIHVzZSBcImFjdGl2aXR5U3RhdHVzTWlkZGxld2FyZVwiIGluc3RlYWQuJ1xuICAgICAgKTtcblxuICAgIHJldHVybiBhY3Rpdml0eVN0YXR1c1JlbmRlcmVyIHx8IGNyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXIoYWN0aXZpdHlTdGF0dXNNaWRkbGV3YXJlKTtcbiAgfSwgW2FjdGl2aXR5U3RhdHVzTWlkZGxld2FyZSwgYWN0aXZpdHlTdGF0dXNSZW5kZXJlcl0pO1xuXG4gIGNvbnN0IHBhdGNoZWRBdHRhY2htZW50UmVuZGVyZXIgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBhdHRhY2htZW50UmVuZGVyZXIgJiZcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ1dlYiBDaGF0OiBcImF0dGFjaG1lbnRSZW5kZXJlclwiIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBvbiAyMDIwLTA2LTE1LCBwbGVhc2UgdXNlIFwiYXR0YWNobWVudE1pZGRsZXdhcmVcIiBpbnN0ZWFkLidcbiAgICAgICk7XG5cbiAgICByZXR1cm4gYXR0YWNobWVudFJlbmRlcmVyIHx8IGNyZWF0ZUF0dGFjaG1lbnRSZW5kZXJlcihhdHRhY2htZW50TWlkZGxld2FyZSk7XG4gIH0sIFthdHRhY2htZW50TWlkZGxld2FyZSwgYXR0YWNobWVudFJlbmRlcmVyXSk7XG5cbiAgY29uc3QgcGF0Y2hlZEF2YXRhclJlbmRlcmVyID0gdXNlTWVtbygoKSA9PiB7XG4gICAgYXZhdGFyUmVuZGVyZXIgJiZcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ1dlYiBDaGF0OiBcImF2YXRhclJlbmRlcmVyXCIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIG9uIDIwMjAtMDYtMTUsIHBsZWFzZSB1c2UgXCJhdmF0YXJNaWRkbGV3YXJlXCIgaW5zdGVhZC4nXG4gICAgICApO1xuXG4gICAgcmV0dXJuIGF2YXRhclJlbmRlcmVyIHx8IGNyZWF0ZUF2YXRhclJlbmRlcmVyKGF2YXRhck1pZGRsZXdhcmUpO1xuICB9LCBbYXZhdGFyTWlkZGxld2FyZSwgYXZhdGFyUmVuZGVyZXJdKTtcblxuICBjb25zdCBwYXRjaGVkVG9hc3RSZW5kZXJlciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHRvYXN0UmVuZGVyZXIgJiZcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ1dlYiBDaGF0OiBcInRvYXN0UmVuZGVyZXJcIiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgb24gMjAyMC0wNi0xNSwgcGxlYXNlIHVzZSBcInRvYXN0TWlkZGxld2FyZVwiIGluc3RlYWQuJ1xuICAgICAgKTtcblxuICAgIHJldHVybiB0b2FzdFJlbmRlcmVyIHx8IGNyZWF0ZVRvYXN0UmVuZGVyZXIodG9hc3RNaWRkbGV3YXJlKTtcbiAgfSwgW3RvYXN0TWlkZGxld2FyZSwgdG9hc3RSZW5kZXJlcl0pO1xuXG4gIGNvbnN0IHBhdGNoZWRUeXBpbmdJbmRpY2F0b3JSZW5kZXJlciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHR5cGluZ0luZGljYXRvclJlbmRlcmVyICYmXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdXZWIgQ2hhdDogXCJ0eXBpbmdJbmRpY2F0b3JSZW5kZXJlclwiIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBvbiAyMDIwLTA2LTE1LCBwbGVhc2UgdXNlIFwidHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZVwiIGluc3RlYWQuJ1xuICAgICAgKTtcblxuICAgIHJldHVybiB0eXBpbmdJbmRpY2F0b3JSZW5kZXJlciB8fCBjcmVhdGVUeXBpbmdJbmRpY2F0b3JSZW5kZXJlcih0eXBpbmdJbmRpY2F0b3JNaWRkbGV3YXJlKTtcbiAgfSwgW3R5cGluZ0luZGljYXRvck1pZGRsZXdhcmUsIHR5cGluZ0luZGljYXRvclJlbmRlcmVyXSk7XG5cbiAgY29uc3QgdHJhbnNjcmlwdEFjdGl2aXR5RWxlbWVudHNSZWYgPSB1c2VSZWYoW10pO1xuICBjb25zdCB0cmFuc2NyaXB0Um9vdEVsZW1lbnRSZWYgPSB1c2VSZWYoKTtcblxuICAvLyBUaGlzIGlzIGEgaGVhdnkgZnVuY3Rpb24sIGFuZCBpdCBpcyBleHBlY3RlZCB0byBiZSBvbmx5IGNhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbmVlZCB0byByZWNyZWF0ZSBidXNpbmVzcyBsb2dpYywgZS5nLlxuICAvLyAtIFVzZXIgSUQgY2hhbmdlZCwgY2F1c2luZyBhbGwgc2VuZCogZnVuY3Rpb25zIHRvIGJlIHVwZGF0ZWRcbiAgLy8gLSBzZW5kXG5cbiAgLy8gVE9ETzogW1AzXSBXZSBzaG91bGQgdGhpbmsgYWJvdXQgaWYgd2UgYWxsb3cgdGhlIHVzZXIgdG8gY2hhbmdlIG9uU2VuZEJveFZhbHVlQ2hhbmdlZC9zZW5kQm94VmFsdWUsIGUuZy5cbiAgLy8gMS4gVHVybnMgdGV4dCBpbnRvIFVQUEVSQ0FTRVxuICAvLyAyLiBGaWx0ZXIgb3V0IHByb2Zhbml0eVxuXG4gIC8vIFRPRE86IFtQNF0gUmV2aXNpdCBhbGwgbWVtYmVycyBvZiBjb250ZXh0XG4gIC8vICAgICAgIFRoaXMgY29udGV4dCBzaG91bGQgY29uc2lzdCBvZiBtZW1iZXJzIHRoYXQgYXJlIG5vdCBpbiB0aGUgUmVkdXggc3RvcmVcbiAgLy8gICAgICAgaS5lLiBtZW1iZXJzIHRoYXQgYXJlIG5vdCBpbnRlcmVzdGVkIGluIG90aGVyIHR5cGVzIG9mIFVJc1xuICBjb25zdCBjb250ZXh0ID0gdXNlTWVtbyhcbiAgICAoKSA9PiAoe1xuICAgICAgLi4uY2FyZEFjdGlvbkNvbnRleHQsXG4gICAgICAuLi5mb2N1c0NvbnRleHQsXG4gICAgICAuLi5ncm91cEFjdGl2aXRpZXNDb250ZXh0LFxuICAgICAgLi4uaG9pc3RlZERpc3BhdGNoZXJzLFxuICAgICAgYWN0aXZpdHlSZW5kZXJlcjogcGF0Y2hlZEFjdGl2aXR5UmVuZGVyZXIsXG4gICAgICBhY3Rpdml0eVN0YXR1c1JlbmRlcmVyOiBwYXRjaGVkQWN0aXZpdHlTdGF0dXNSZW5kZXJlcixcbiAgICAgIGF0dGFjaG1lbnRSZW5kZXJlcjogcGF0Y2hlZEF0dGFjaG1lbnRSZW5kZXJlcixcbiAgICAgIGF2YXRhclJlbmRlcmVyOiBwYXRjaGVkQXZhdGFyUmVuZGVyZXIsXG4gICAgICBkaWN0YXRlQWJvcnRhYmxlLFxuICAgICAgZGlyOiBwYXRjaGVkRGlyLFxuICAgICAgZGlyZWN0TGluZSxcbiAgICAgIGRpc2FibGVkLFxuICAgICAgZ3JhbW1hcnM6IHBhdGNoZWRHcmFtbWFycyxcbiAgICAgIGludGVybmFsTWFya2Rvd25JdFN0YXRlOiBbaW50ZXJuYWxNYXJrZG93bkl0XSxcbiAgICAgIGludGVybmFsUmVuZGVyTWFya2Rvd25JbmxpbmUsXG4gICAgICBsYW5ndWFnZTogbG9jYWxlLFxuICAgICAgbG9jYWxpemVkR2xvYmFsaXplU3RhdGU6IFtsb2NhbGl6ZWRHbG9iYWxpemVdLFxuICAgICAgbG9jYWxpemVkU3RyaW5nczogcGF0Y2hlZExvY2FsaXplZFN0cmluZ3MsXG4gICAgICBvblRlbGVtZXRyeSxcbiAgICAgIHJlbmRlck1hcmtkb3duLFxuICAgICAgc2VsZWN0Vm9pY2U6IHBhdGNoZWRTZWxlY3RWb2ljZSxcbiAgICAgIHNlbmRCb3hGb2N1c1JlZixcbiAgICAgIHNlbmRUeXBpbmdJbmRpY2F0b3IsXG4gICAgICBzZXREaWN0YXRlQWJvcnRhYmxlLFxuICAgICAgc3R5bGVPcHRpb25zLFxuICAgICAgc3R5bGVTZXQ6IHBhdGNoZWRTdHlsZVNldCxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXksXG4gICAgICB0ZWxlbWV0cnlEaW1lbnNpb25zUmVmLFxuICAgICAgdG9hc3RSZW5kZXJlcjogcGF0Y2hlZFRvYXN0UmVuZGVyZXIsXG4gICAgICB0cmFja0RpbWVuc2lvbixcbiAgICAgIHRyYW5zY3JpcHRBY3Rpdml0eUVsZW1lbnRzUmVmLFxuICAgICAgdHJhbnNjcmlwdEZvY3VzUmVmLFxuICAgICAgdHJhbnNjcmlwdFJvb3RFbGVtZW50UmVmLFxuICAgICAgdHlwaW5nSW5kaWNhdG9yUmVuZGVyZXI6IHBhdGNoZWRUeXBpbmdJbmRpY2F0b3JSZW5kZXJlcixcbiAgICAgIHVzZXJJRCxcbiAgICAgIHVzZXJuYW1lLFxuICAgICAgd2ViU3BlZWNoUG9ueWZpbGxcbiAgICB9KSxcbiAgICBbXG4gICAgICBjYXJkQWN0aW9uQ29udGV4dCxcbiAgICAgIGRpY3RhdGVBYm9ydGFibGUsXG4gICAgICBkaXJlY3RMaW5lLFxuICAgICAgZGlzYWJsZWQsXG4gICAgICBmb2N1c0NvbnRleHQsXG4gICAgICBncm91cEFjdGl2aXRpZXNDb250ZXh0LFxuICAgICAgaG9pc3RlZERpc3BhdGNoZXJzLFxuICAgICAgaW50ZXJuYWxNYXJrZG93bkl0LFxuICAgICAgaW50ZXJuYWxSZW5kZXJNYXJrZG93bklubGluZSxcbiAgICAgIGxvY2FsZSxcbiAgICAgIGxvY2FsaXplZEdsb2JhbGl6ZSxcbiAgICAgIG9uVGVsZW1ldHJ5LFxuICAgICAgcGF0Y2hlZEFjdGl2aXR5UmVuZGVyZXIsXG4gICAgICBwYXRjaGVkQWN0aXZpdHlTdGF0dXNSZW5kZXJlcixcbiAgICAgIHBhdGNoZWRBdHRhY2htZW50UmVuZGVyZXIsXG4gICAgICBwYXRjaGVkQXZhdGFyUmVuZGVyZXIsXG4gICAgICBwYXRjaGVkRGlyLFxuICAgICAgcGF0Y2hlZEdyYW1tYXJzLFxuICAgICAgcGF0Y2hlZExvY2FsaXplZFN0cmluZ3MsXG4gICAgICBwYXRjaGVkU2VsZWN0Vm9pY2UsXG4gICAgICBwYXRjaGVkU3R5bGVTZXQsXG4gICAgICBwYXRjaGVkVG9hc3RSZW5kZXJlcixcbiAgICAgIHBhdGNoZWRUeXBpbmdJbmRpY2F0b3JSZW5kZXJlcixcbiAgICAgIHJlbmRlck1hcmtkb3duLFxuICAgICAgc2VuZEJveEZvY3VzUmVmLFxuICAgICAgc2VuZFR5cGluZ0luZGljYXRvcixcbiAgICAgIHNldERpY3RhdGVBYm9ydGFibGUsXG4gICAgICBzdHlsZU9wdGlvbnMsXG4gICAgICBzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5LFxuICAgICAgdGVsZW1ldHJ5RGltZW5zaW9uc1JlZixcbiAgICAgIHRyYWNrRGltZW5zaW9uLFxuICAgICAgdHJhbnNjcmlwdEFjdGl2aXR5RWxlbWVudHNSZWYsXG4gICAgICB0cmFuc2NyaXB0Rm9jdXNSZWYsXG4gICAgICB0cmFuc2NyaXB0Um9vdEVsZW1lbnRSZWYsXG4gICAgICB1c2VySUQsXG4gICAgICB1c2VybmFtZSxcbiAgICAgIHdlYlNwZWVjaFBvbnlmaWxsXG4gICAgXVxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPFdlYkNoYXRVSUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHR9PlxuICAgICAgPFNheUNvbXBvc2VyIHBvbnlmaWxsPXt3ZWJTcGVlY2hQb255ZmlsbH0+XG4gICAgICAgIHt0eXBlb2YgY2hpbGRyZW4gPT09ICdmdW5jdGlvbicgPyBjaGlsZHJlbihjb250ZXh0KSA6IGNoaWxkcmVufVxuICAgICAgPC9TYXlDb21wb3Nlcj5cbiAgICAgIDxEaWN0YXRpb24gb25FcnJvcj17ZGljdGF0aW9uT25FcnJvcn0gLz5cbiAgICAgIHtvblRlbGVtZXRyeSAmJiA8VHJhY2tlciAvPn1cbiAgICA8L1dlYkNoYXRVSUNvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59O1xuXG4vLyBXZSB3aWxsIGNyZWF0ZSBhIFJlZHV4IHN0b3JlIGlmIGl0IHdhcyBub3QgcGFzc2VkIGluXG5jb25zdCBDb21wb3NlV2l0aFN0b3JlID0gKHsgb25UZWxlbWV0cnksIHN0b3JlLCAuLi5wcm9wcyB9KSA9PiB7XG4gIGNvbnN0IGhhbmRsZUVycm9yID0gdXNlQ2FsbGJhY2soXG4gICAgKHsgZXJyb3IgfSkgPT4ge1xuICAgICAgb25UZWxlbWV0cnkgJiYgb25UZWxlbWV0cnkoY3JlYXRlQ3VzdG9tRXZlbnQoJ2V4Y2VwdGlvbicsIHsgZXJyb3IsIGZhdGFsOiB0cnVlIH0pKTtcbiAgICB9LFxuICAgIFtvblRlbGVtZXRyeV1cbiAgKTtcblxuICBjb25zdCBtZW1vaXplZFN0b3JlID0gdXNlTWVtbygoKSA9PiBzdG9yZSB8fCBjcmVhdGVTdG9yZSgpLCBbc3RvcmVdKTtcblxuICByZXR1cm4gKFxuICAgIDxFcnJvckJvdW5kYXJ5IG9uRXJyb3I9e2hhbmRsZUVycm9yfT5cbiAgICAgIDxQcm92aWRlciBjb250ZXh0PXtXZWJDaGF0UmVkdXhDb250ZXh0fSBzdG9yZT17bWVtb2l6ZWRTdG9yZX0+XG4gICAgICAgIDxTY3JvbGxUb0JvdHRvbUNvbXBvc2VyPlxuICAgICAgICAgIDxDb21wb3NlciBvblRlbGVtZXRyeT17b25UZWxlbWV0cnl9IHsuLi5wcm9wc30gLz5cbiAgICAgICAgPC9TY3JvbGxUb0JvdHRvbUNvbXBvc2VyPlxuICAgICAgPC9Qcm92aWRlcj5cbiAgICA8L0Vycm9yQm91bmRhcnk+XG4gICk7XG59O1xuXG5Db21wb3NlV2l0aFN0b3JlLmRlZmF1bHRQcm9wcyA9IHtcbiAgb25UZWxlbWV0cnk6IHVuZGVmaW5lZCxcbiAgc3RvcmU6IHVuZGVmaW5lZFxufTtcblxuQ29tcG9zZVdpdGhTdG9yZS5wcm9wVHlwZXMgPSB7XG4gIG9uVGVsZW1ldHJ5OiBQcm9wVHlwZXMuZnVuYyxcbiAgc3RvcmU6IFByb3BUeXBlcy5hbnlcbn07XG5cbmV4cG9ydCBkZWZhdWx0IENvbXBvc2VXaXRoU3RvcmU7XG5cbi8vIFRPRE86IFtQM10gV2Ugc2hvdWxkIGNvbnNpZGVyIG1vdmluZyBzb21lIGRhdGEgZnJvbSBSZWR1eCBzdG9yZSB0byBwcm9wc1xuLy8gICAgICAgQWx0aG91Z2ggd2UgdXNlIGBjb25uZWN0VG9XZWJDaGF0YCB0byBoaWRlIHRoZSBkZXRhaWxzIG9mIGFjY2Vzc29yIG9mIFJlZHV4IHN0b3JlLFxuLy8gICAgICAgd2Ugc2hvdWxkIGNsZWFuIHVwIHRoZSByZXNwb25zaWJpbGl0eSBiZXR3ZWVuIENvbnRleHQgYW5kIFJlZHV4IHN0b3JlXG4vLyAgICAgICBXZSBzaG91bGQgZGVjaWRlIHdoaWNoIGRhdGEgaXMgbmVlZGVkIGZvciBSZWFjdCBidXQgbm90IGluIG90aGVyIGVudmlyb25tZW50IHN1Y2ggYXMgQ0xJL1ZTQ29kZVxuXG5Db21wb3Nlci5kZWZhdWx0UHJvcHMgPSB7XG4gIGFjdGl2aXR5TWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBhY3Rpdml0eVJlbmRlcmVyOiB1bmRlZmluZWQsXG4gIGFjdGl2aXR5U3RhdHVzTWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBhY3Rpdml0eVN0YXR1c1JlbmRlcmVyOiB1bmRlZmluZWQsXG4gIGF0dGFjaG1lbnRNaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIGF0dGFjaG1lbnRSZW5kZXJlcjogdW5kZWZpbmVkLFxuICBhdmF0YXJNaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIGF2YXRhclJlbmRlcmVyOiB1bmRlZmluZWQsXG4gIGNhcmRBY3Rpb25NaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIGNoaWxkcmVuOiB1bmRlZmluZWQsXG4gIGRpcjogJ2F1dG8nLFxuICBkaXNhYmxlZDogZmFsc2UsXG4gIGV4dHJhU3R5bGVTZXQ6IHVuZGVmaW5lZCxcbiAgZ3JhbW1hcnM6IFtdLFxuICBncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIGdyb3VwVGltZXN0YW1wOiB1bmRlZmluZWQsXG4gIGxvY2FsZTogd2luZG93Lm5hdmlnYXRvci5sYW5ndWFnZSB8fCAnZW4tVVMnLFxuICBvblRlbGVtZXRyeTogdW5kZWZpbmVkLFxuICBvdmVycmlkZUxvY2FsaXplZFN0cmluZ3M6IHVuZGVmaW5lZCxcbiAgcmVuZGVyTWFya2Rvd246IHVuZGVmaW5lZCxcbiAgc2VsZWN0Vm9pY2U6IHVuZGVmaW5lZCxcbiAgc2VuZFRpbWVvdXQ6IHVuZGVmaW5lZCxcbiAgc2VuZFR5cGluZ0luZGljYXRvcjogZmFsc2UsXG4gIHN0eWxlT3B0aW9uczoge30sXG4gIHN0eWxlU2V0OiB1bmRlZmluZWQsXG4gIHN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXk6ICdBIGEgw4Ugw6UnLFxuICB0b2FzdE1pZGRsZXdhcmU6IHVuZGVmaW5lZCxcbiAgdG9hc3RSZW5kZXJlcjogdW5kZWZpbmVkLFxuICB0eXBpbmdJbmRpY2F0b3JNaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIHR5cGluZ0luZGljYXRvclJlbmRlcmVyOiB1bmRlZmluZWQsXG4gIHVzZXJJRDogJycsXG4gIHVzZXJuYW1lOiAnJyxcbiAgd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5OiB1bmRlZmluZWRcbn07XG5cbkNvbXBvc2VyLnByb3BUeXBlcyA9IHtcbiAgYWN0aXZpdHlNaWRkbGV3YXJlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWN0aXZpdHlSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGFjdGl2aXR5U3RhdHVzTWlkZGxld2FyZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGFjdGl2aXR5U3RhdHVzUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICBhdHRhY2htZW50TWlkZGxld2FyZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGF0dGFjaG1lbnRSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGF2YXRhck1pZGRsZXdhcmU6IFByb3BUeXBlcy5mdW5jLFxuICBhdmF0YXJSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGNhcmRBY3Rpb25NaWRkbGV3YXJlOiBQcm9wVHlwZXMuZnVuYyxcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5hbnksXG4gIGRpcjogUHJvcFR5cGVzLm9uZU9mKFsnYXV0bycsICdsdHInLCAncnRsJ10pLFxuICBkaXJlY3RMaW5lOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgIGFjdGl2aXR5JDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIHN1YnNjcmliZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuICAgIH0pLmlzUmVxdWlyZWQsXG4gICAgY29ubmVjdGlvblN0YXR1cyQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBzdWJzY3JpYmU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcbiAgICB9KS5pc1JlcXVpcmVkLFxuICAgIGVuZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZ2V0U2Vzc2lvbklkOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBwb3N0QWN0aXZpdHk6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgcmVmZXJlbmNlR3JhbW1hcklEOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHRva2VuOiBQcm9wVHlwZXMuc3RyaW5nXG4gIH0pLmlzUmVxdWlyZWQsXG4gIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgZXh0cmFTdHlsZVNldDogUHJvcFR5cGVzLmFueSxcbiAgZ3JhbW1hcnM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zdHJpbmcpLFxuICBncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlOiBQcm9wVHlwZXMuZnVuYyxcbiAgZ3JvdXBUaW1lc3RhbXA6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5ib29sLCBQcm9wVHlwZXMubnVtYmVyXSksXG4gIGxvY2FsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgb25UZWxlbWV0cnk6IFByb3BUeXBlcy5mdW5jLFxuICBvdmVycmlkZUxvY2FsaXplZFN0cmluZ3M6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hbnksIFByb3BUeXBlcy5mdW5jXSksXG4gIHJlbmRlck1hcmtkb3duOiBQcm9wVHlwZXMuZnVuYyxcbiAgc2VsZWN0Vm9pY2U6IFByb3BUeXBlcy5mdW5jLFxuICBzZW5kVGltZW91dDogUHJvcFR5cGVzLm51bWJlcixcbiAgc2VuZFR5cGluZ0luZGljYXRvcjogUHJvcFR5cGVzLmJvb2wsXG4gIHN0eWxlT3B0aW9uczogUHJvcFR5cGVzLmFueSxcbiAgc3R5bGVTZXQ6IFByb3BUeXBlcy5hbnksXG4gIHN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXk6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5vbmVPZihbZmFsc2VdKSwgUHJvcFR5cGVzLnN0cmluZ10pLFxuICB0b2FzdE1pZGRsZXdhcmU6IFByb3BUeXBlcy5mdW5jLFxuICB0b2FzdFJlbmRlcmVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgdHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZTogUHJvcFR5cGVzLmZ1bmMsXG4gIHR5cGluZ0luZGljYXRvclJlbmRlcmVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgdXNlcklEOiBQcm9wVHlwZXMuc3RyaW5nLFxuICB1c2VybmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5OiBQcm9wVHlwZXMuZnVuY1xufTtcbiJdfQ==