"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _glamor = require("glamor");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _isZeroOrPositive = _interopRequireDefault(require("../Utils/isZeroOrPositive"));

var _useDirection3 = _interopRequireDefault(require("../hooks/useDirection"));

var _useStyleOptions3 = _interopRequireDefault(require("../hooks/useStyleOptions"));

var _useStyleSet3 = _interopRequireDefault(require("../hooks/useStyleSet"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var ROOT_CSS = (0, _glamor.css)({
  '&.webchat__bubble': {
    display: 'flex',
    position: 'relative',
    '& .webchat__bubble__nub-pad': {
      flexShrink: 0
    },
    '& .webchat__bubble__content': {
      flexGrow: 1,
      // This is for hiding content outside of the bubble, for example, content outside of border radius
      overflow: 'hidden'
    }
  }
});

function acuteNubSVG(nubSize, strokeWidth, side) {
  var upSideDown = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

  if (typeof nubSize !== 'number') {
    return false;
  }

  var halfNubSize = nubSize / 2;
  var halfStrokeWidth = strokeWidth / 2; // Horizontally mirror the nub if it is from user

  var horizontalTransform = side === 'bot' ? '' : "translate(".concat(halfNubSize, " 0) scale(-1 1) translate(").concat(-halfNubSize, " 0)"); // Vertically mirror the nub if it is up-side-down

  var verticalTransform = upSideDown ? "translate(0 ".concat(halfNubSize, ") scale(1 -1) translate(0 ").concat(-halfNubSize, ")") : '';
  var p1 = [nubSize, halfStrokeWidth].join(' ');
  var p2 = [strokeWidth, halfStrokeWidth].join(' ');
  var p3 = [nubSize + strokeWidth, nubSize + halfStrokeWidth].join(' ');
  return /*#__PURE__*/_react.default.createElement("svg", {
    className: "webchat__bubble__nub",
    version: "1.1",
    viewBox: "0 0 ".concat(nubSize, " ").concat(nubSize),
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/_react.default.createElement("g", {
    transform: "".concat(horizontalTransform, " ").concat(verticalTransform)
  }, /*#__PURE__*/_react.default.createElement("path", {
    className: "webchat__bubble__nub-outline",
    d: "M".concat(p1, " L").concat(p2, " L").concat(p3)
  })));
}

var Bubble = function Bubble(_ref) {
  var ariaHidden = _ref['aria-hidden'],
      children = _ref.children,
      className = _ref.className,
      fromUser = _ref.fromUser,
      nub = _ref.nub;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      bubbleStyleSet = _useStyleSet2[0].bubble;

  var _useDirection = (0, _useDirection3.default)(),
      _useDirection2 = _slicedToArray(_useDirection, 1),
      direction = _useDirection2[0];

  var _useStyleOptions = (0, _useStyleOptions3.default)(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      _useStyleOptions2$ = _useStyleOptions2[0],
      bubbleBorderWidth = _useStyleOptions2$.bubbleBorderWidth,
      bubbleFromUserBorderWidth = _useStyleOptions2$.bubbleFromUserBorderWidth,
      bubbleFromUserNubSize = _useStyleOptions2$.bubbleFromUserNubSize,
      bubbleNubSize = _useStyleOptions2$.bubbleNubSize,
      bubbleNubOffset = _useStyleOptions2$.bubbleNubOffset,
      bubbleFromUserNubOffset = _useStyleOptions2$.bubbleFromUserNubOffset;

  var _ref2 = fromUser ? {
    borderWidth: bubbleFromUserBorderWidth,
    nubOffset: bubbleFromUserNubOffset,
    nubSize: bubbleFromUserNubSize,
    side: 'user'
  } : {
    borderWidth: bubbleBorderWidth,
    nubOffset: bubbleNubOffset,
    nubSize: bubbleNubSize,
    side: 'bot'
  },
      borderWidth = _ref2.borderWidth,
      nubOffset = _ref2.nubOffset,
      nubSize = _ref2.nubSize,
      side = _ref2.side;

  return /*#__PURE__*/_react.default.createElement("div", {
    "aria-hidden": ariaHidden,
    className: (0, _classnames.default)('webchat__bubble', ROOT_CSS + '', bubbleStyleSet + '', {
      'webchat__bubble--from-user': fromUser,
      'webchat__bubble--hide-nub': nub !== true && nub !== false,
      'webchat__bubble--nub-on-top': (0, _isZeroOrPositive.default)(nubOffset),
      'webchat__bubble--rtl': direction === 'rtl',
      'webchat__bubble--show-nub': nub === true
    }, className + '' || '')
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__bubble__nub-pad"
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__bubble__content"
  }, children), nub === true && acuteNubSVG(nubSize, borderWidth, side, !(0, _isZeroOrPositive.default)(nubOffset)));
};

Bubble.defaultProps = {
  'aria-hidden': undefined,
  children: undefined,
  className: '',
  fromUser: false,
  nub: false
};
Bubble.propTypes = {
  'aria-hidden': _propTypes.default.bool,
  children: _propTypes.default.any,
  className: _propTypes.default.string,
  fromUser: _propTypes.default.bool,
  nub: _propTypes.default.oneOf([true, false, 'hidden'])
};
var _default = Bubble;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9BY3Rpdml0eS9CdWJibGUuanMiXSwibmFtZXMiOlsiUk9PVF9DU1MiLCJkaXNwbGF5IiwicG9zaXRpb24iLCJmbGV4U2hyaW5rIiwiZmxleEdyb3ciLCJvdmVyZmxvdyIsImFjdXRlTnViU1ZHIiwibnViU2l6ZSIsInN0cm9rZVdpZHRoIiwic2lkZSIsInVwU2lkZURvd24iLCJoYWxmTnViU2l6ZSIsImhhbGZTdHJva2VXaWR0aCIsImhvcml6b250YWxUcmFuc2Zvcm0iLCJ2ZXJ0aWNhbFRyYW5zZm9ybSIsInAxIiwiam9pbiIsInAyIiwicDMiLCJCdWJibGUiLCJhcmlhSGlkZGVuIiwiY2hpbGRyZW4iLCJjbGFzc05hbWUiLCJmcm9tVXNlciIsIm51YiIsImJ1YmJsZVN0eWxlU2V0IiwiYnViYmxlIiwiZGlyZWN0aW9uIiwiYnViYmxlQm9yZGVyV2lkdGgiLCJidWJibGVGcm9tVXNlckJvcmRlcldpZHRoIiwiYnViYmxlRnJvbVVzZXJOdWJTaXplIiwiYnViYmxlTnViU2l6ZSIsImJ1YmJsZU51Yk9mZnNldCIsImJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0IiwiYm9yZGVyV2lkdGgiLCJudWJPZmZzZXQiLCJkZWZhdWx0UHJvcHMiLCJ1bmRlZmluZWQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJib29sIiwiYW55Iiwic3RyaW5nIiwib25lT2YiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQU1BLFFBQVEsR0FBRyxpQkFBSTtBQUNuQix1QkFBcUI7QUFDbkJDLElBQUFBLE9BQU8sRUFBRSxNQURVO0FBRW5CQyxJQUFBQSxRQUFRLEVBQUUsVUFGUztBQUluQixtQ0FBK0I7QUFDN0JDLE1BQUFBLFVBQVUsRUFBRTtBQURpQixLQUpaO0FBUW5CLG1DQUErQjtBQUM3QkMsTUFBQUEsUUFBUSxFQUFFLENBRG1CO0FBRzdCO0FB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RUFBRWtCLG1CQUFVRSxHQUZIO0FBR2pCbkIsRUFBQUEsU0FBUyxFQUFFaUIsbUJBQVVHLE1BSEo7QUFJakJuQixFQUFBQSxRQUFRLEVBQUVnQixtQkFBVUMsSUFKSDtBQUtqQmhCLEVBQUFBLEdBQUcsRUFBRWUsbUJBQVVJLEtBQVYsQ0FBZ0IsQ0FBQyxJQUFELEVBQU8sS0FBUCxFQUFjLFFBQWQsQ0FBaEI7QUFMWSxDQUFuQjtlQVFleEIsTSIsInNvdXJjZVJvb3QiOiJjb21wb25lbnQ6Ly8vIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50IG5vLW1hZ2ljLW51bWJlcnM6IFtcImVycm9yXCIsIHsgXCJpZ25vcmVcIjogWy0xLCAwLCAxLCAyLCAxMF0gfV0gKi9cblxuaW1wb3J0IHsgY3NzIH0gZnJvbSAnZ2xhbW9yJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBpc1plcm9PclBvc2l0aXZlIGZyb20gJy4uL1V0aWxzL2lzWmVyb09yUG9zaXRpdmUnO1xuaW1wb3J0IHVzZURpcmVjdGlvbiBmcm9tICcuLi9ob29rcy91c2VEaXJlY3Rpb24nO1xuaW1wb3J0IHVzZVN0eWxlT3B0aW9ucyBmcm9tICcuLi9ob29rcy91c2VTdHlsZU9wdGlvbnMnO1xuaW1wb3J0IHVzZVN0eWxlU2V0IGZyb20gJy4uL2hvb2tzL3VzZVN0eWxlU2V0JztcblxuY29uc3QgUk9PVF9DU1MgPSBjc3Moe1xuICAnJi53ZWJjaGF0X19idWJibGUnOiB7XG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuXG4gICAgJyYgLndlYmNoYXRfX2J1YmJsZV9fbnViLXBhZCc6IHtcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2J1YmJsZV9fY29udGVudCc6IHtcbiAgICAgIGZsZXhHcm93OiAxLFxuXG4gICAgICAvLyBUaGlzIGlzIGZvciBoaWRpbmcgY29udGVudCBvdXRzaWRlIG9mIHRoZSBidWJibGUsIGZvciBleGFtcGxlLCBjb250ZW50IG91dHNpZGUgb2YgYm9yZGVyIHJhZGl1c1xuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXG4gICAgfVxuICB9XG59KTtcblxuZnVuY3Rpb24gYWN1dGVOdWJTVkcobnViU2l6ZSwgc3Ryb2tlV2lkdGgsIHNpZGUsIHVwU2lkZURvd24gPSBmYWxzZSkge1xuICBpZiAodHlwZW9mIG51YlNpemUgIT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgaGFsZk51YlNpemUgPSBudWJTaXplIC8gMjtcbiAgY29uc3QgaGFsZlN0cm9rZVdpZHRoID0gc3Ryb2tlV2lkdGggLyAyO1xuXG4gIC8vIEhvcml6b250YWxseSBtaXJyb3IgdGhlIG51YiBpZiBpdCBpcyBmcm9tIHVzZXJcbiAgY29uc3QgaG9yaXpvbnRhbFRyYW5zZm9ybSA9XG4gICAgc2lkZSA9PT0gJ2JvdCcgPyAnJyA6IGB0cmFuc2xhdGUoJHtoYWxmTnViU2l6ZX0gMCkgc2NhbGUoLTEgMSkgdHJhbnNsYXRlKCR7LWhhbGZOdWJTaXplfSAwKWA7XG5cbiAgLy8gVmVydGljYWxseSBtaXJyb3IgdGhlIG51YiBpZiBpdCBpcyB1cC1zaWRlLWRvd25cbiAgY29uc3QgdmVydGljYWxUcmFuc2Zvcm0gPSB1cFNpZGVEb3duID8gYHRyYW5zbGF0ZSgwICR7aGFsZk51YlNpemV9KSBzY2FsZSgxIC0xKSB0cmFuc2xhdGUoMCAkey1oYWxmTnViU2l6ZX0pYCA6ICcnO1xuXG4gIGNvbnN0IHAxID0gW251YlNpemUsIGhhbGZTdHJva2VXaWR0aF0uam9pbignICcpO1xuICBjb25zdCBwMiA9IFtzdHJva2VXaWR0aCwgaGFsZlN0cm9rZVdpZHRoXS5qb2luKCcgJyk7XG4gIGNvbnN0IHAzID0gW251YlNpemUgKyBzdHJva2VXaWR0aCwgbnViU2l6ZSArIGhhbGZTdHJva2VXaWR0aF0uam9pbignICcpO1xuXG4gIHJldHVybiAoXG4gICAgPHN2Z1xuICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fYnViYmxlX19udWJcIlxuICAgICAgdmVyc2lvbj1cIjEuMVwiXG4gICAgICB2aWV3Qm94PXtgMCAwICR7bnViU2l6ZX0gJHtudWJTaXplfWB9XG4gICAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgICA+XG4gICAgICA8ZyB0cmFuc2Zvcm09e2Ake2hvcml6b250YWxUcmFuc2Zvcm19ICR7dmVydGljYWxUcmFuc2Zvcm19YH0+XG4gICAgICAgIDxwYXRoIGNsYXNzTmFtZT1cIndlYmNoYXRfX2J1YmJsZV9fbnViLW91dGxpbmVcIiBkPXtgTSR7cDF9IEwke3AyfSBMJHtwM31gfSAvPlxuICAgICAgPC9nPlxuICAgIDwvc3ZnPlxuICApO1xufVxuXG5jb25zdCBCdWJibGUgPSAoeyAnYXJpYS1oaWRkZW4nOiBhcmlhSGlkZGVuLCBjaGlsZHJlbiwgY2xhc3NOYW1lLCBmcm9tVXNlciwgbnViIH0pID0+IHtcbiAgY29uc3QgW3sgYnViYmxlOiBidWJibGVTdHlsZVNldCB9XSA9IHVzZVN0eWxlU2V0KCk7XG4gIGNvbnN0IFtkaXJlY3Rpb25dID0gdXNlRGlyZWN0aW9uKCk7XG4gIGNvbnN0IFtcbiAgICB7XG4gICAgICBidWJibGVCb3JkZXJXaWR0aCxcbiAgICAgIGJ1YmJsZUZyb21Vc2VyQm9yZGVyV2lkdGgsXG4gICAgICBidWJibGVGcm9tVXNlck51YlNpemUsXG4gICAgICBidWJibGVOdWJTaXplLFxuICAgICAgYnViYmxlTnViT2Zmc2V0LFxuICAgICAgYnViYmxlRnJvbVVzZXJOdWJPZmZzZXRcbiAgICB9XG4gIF0gPSB1c2VTdHlsZU9wdGlvbnMoKTtcblxuICBjb25zdCB7IGJvcmRlcldpZHRoLCBudWJPZmZzZXQsIG51YlNpemUsIHNpZGUgfSA9IGZyb21Vc2VyXG4gICAgPyB7XG4gICAgICAgIGJvcmRlcldpZHRoOiBidWJibGVGcm9tVXNlckJvcmRlcldpZHRoLFxuICAgICAgICBudWJPZmZzZXQ6IGJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0LFxuICAgICAgICBudWJTaXplOiBidWJibGVGcm9tVXNlck51YlNpemUsXG4gICAgICAgIHNpZGU6ICd1c2VyJ1xuICAgICAgfVxuICAgIDoge1xuICAgICAgICBib3JkZXJXaWR0aDogYnViYmxlQm9yZGVyV2lkdGgsXG4gICAgICAgIG51Yk9mZnNldDogYnViYmxlTnViT2Zmc2V0LFxuICAgICAgICBudWJTaXplOiBidWJibGVOdWJTaXplLFxuICAgICAgICBzaWRlOiAnYm90J1xuICAgICAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGFyaWEtaGlkZGVuPXthcmlhSGlkZGVufVxuICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKFxuICAgICAgICAnd2ViY2hhdF9fYnViYmxlJyxcbiAgICAgICAgUk9PVF9DU1MgKyAnJyxcbiAgICAgICAgYnViYmxlU3R5bGVTZXQgKyAnJyxcbiAgICAgICAge1xuICAgICAgICAgICd3ZWJjaGF0X19idWJibGUtLWZyb20tdXNlcic6IGZyb21Vc2VyLFxuICAgICAgICAgICd3ZWJjaGF0X19idWJibGUtLWhpZGUtbnViJzogbnViICE9PSB0cnVlICYmIG51YiAhPT0gZmFsc2UsXG4gICAgICAgICAgJ3dlYmNoYXRfX2J1YmJsZS0tbnViLW9uLXRvcCc6IGlzWmVyb09yUG9zaXRpdmUobnViT2Zmc2V0KSxcbiAgICAgICAgICAnd2ViY2hhdF9fYnViYmxlLS1ydGwnOiBkaXJlY3Rpb24gPT09ICdydGwnLFxuICAgICAgICAgICd3ZWJjaGF0X19idWJibGUtLXNob3ctbnViJzogbnViID09PSB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGNsYXNzTmFtZSArICcnIHx8ICcnXG4gICAgICApfVxuICAgID5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fYnViYmxlX19udWItcGFkXCIgLz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fYnViYmxlX19jb250ZW50XCI+e2NoaWxkcmVufTwvZGl2PlxuICAgICAge251YiA9PT0gdHJ1ZSAmJiBhY3V0ZU51YlNWRyhudWJTaXplLCBib3JkZXJXaWR0aCwgc2lkZSwgIWlzWmVyb09yUG9zaXRpdmUobnViT2Zmc2V0KSl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5CdWJibGUuZGVmYXVsdFByb3BzID0ge1xuICAnYXJpYS1oaWRkZW4nOiB1bmRlZmluZWQsXG4gIGNoaWxkcmVuOiB1bmRlZmluZWQsXG4gIGNsYXNzTmFtZTogJycsXG4gIGZyb21Vc2VyOiBmYWxzZSxcbiAgbnViOiBmYWxzZVxufTtcblxuQnViYmxlLnByb3BUeXBlcyA9IHtcbiAgJ2FyaWEtaGlkZGVuJzogUHJvcFR5cGVzLmJvb2wsXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZyb21Vc2VyOiBQcm9wVHlwZXMuYm9vbCxcbiAgbnViOiBQcm9wVHlwZXMub25lT2YoW3RydWUsIGZhbHNlLCAnaGlkZGVuJ10pXG59O1xuXG5leHBvcnQgZGVmYXVsdCBCdWJibGU7XG4iXX0=