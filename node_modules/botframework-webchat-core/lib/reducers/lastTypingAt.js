"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = lastTypingAt;

var _simpleUpdateIn = _interopRequireDefault(require("simple-update-in"));

var _incomingActivity = require("../actions/incomingActivity");

/*eslint no-case-declarations: "off"*/

/*eslint no-unused-vars: "off"*/
var DEFAULT_STATE = {};

function lastTypingAt() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_STATE;

  var _ref = arguments.length > 1 ? arguments[1] : undefined,
      payload = _ref.payload,
      type = _ref.type;

  if (type === _incomingActivity.INCOMING_ACTIVITY) {
    var _payload$activity = payload.activity,
        _payload$activity$fro = _payload$activity.from,
        id = _payload$activity$fro.id,
        role = _payload$activity$fro.role,
        activityType = _payload$activity.type;

    if (role !== 'user') {
      if (activityType === 'typing') {
        state = (0, _simpleUpdateIn["default"])(state, [id], function () {
          return Date.now();
        });
      } else if (activityType === 'message') {
        state = (0, _simpleUpdateIn["default"])(state, [id]);
      }
    }
  }

  return state;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yZWR1Y2Vycy9sYXN0VHlwaW5nQXQuanMiXSwibmFtZXMiOlsiREVGQVVMVF9TVEFURSIsImxhc3RUeXBpbmdBdCIsInN0YXRlIiwicGF5bG9hZCIsInR5cGUiLCJJTkNPTUlOR19BQ1RJVklUWSIsImFjdGl2aXR5IiwiZnJvbSIsImlkIiwicm9sZSIsImFjdGl2aXR5VHlwZSIsIkRhdGUiLCJub3ciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUdBOztBQUVBOztBQUxBOztBQUNBO0FBTUEsSUFBTUEsYUFBYSxHQUFHLEVBQXRCOztBQUVlLFNBQVNDLFlBQVQsR0FBZ0U7QUFBQSxNQUExQ0MsS0FBMEMsdUVBQWxDRixhQUFrQzs7QUFBQTtBQUFBLE1BQWpCRyxPQUFpQixRQUFqQkEsT0FBaUI7QUFBQSxNQUFSQyxJQUFRLFFBQVJBLElBQVE7O0FBQzdFLE1BQUlBLElBQUksS0FBS0MsbUNBQWIsRUFBZ0M7QUFBQSw0QkFNMUJGLE9BTjBCLENBRTVCRyxRQUY0QjtBQUFBLGtEQUcxQkMsSUFIMEI7QUFBQSxRQUdsQkMsRUFIa0IseUJBR2xCQSxFQUhrQjtBQUFBLFFBR2RDLElBSGMseUJBR2RBLElBSGM7QUFBQSxRQUlwQkMsWUFKb0IscUJBSTFCTixJQUowQjs7QUFROUIsUUFBSUssSUFBSSxLQUFLLE1BQWIsRUFBcUI7QUFDbkIsVUFBSUMsWUFBWSxLQUFLLFFBQXJCLEVBQStCO0FBQzdCUixRQUFBQSxLQUFLLEdBQUcsZ0NBQVNBLEtBQVQsRUFBZ0IsQ0FBQ00sRUFBRCxDQUFoQixFQUFzQjtBQUFBLGlCQUFNRyxJQUFJLENBQUNDLEdBQUwsRUFBTjtBQUFBLFNBQXRCLENBQVI7QUFDRCxPQUZELE1BRU8sSUFBSUYsWUFBWSxLQUFLLFNBQXJCLEVBQWdDO0FBQ3JDUixRQUFBQSxLQUFLLEdBQUcsZ0NBQVNBLEtBQVQsRUFBZ0IsQ0FBQ00sRUFBRCxDQUFoQixDQUFSO0FBQ0Q7QUFDRjtBQUNGOztBQUVELFNBQU9OLEtBQVA7QUFDRCIsInNvdXJjZVJvb3QiOiJjb3JlOi8vLyIsInNvdXJjZXNDb250ZW50IjpbIi8qZXNsaW50IG5vLWNhc2UtZGVjbGFyYXRpb25zOiBcIm9mZlwiKi9cbi8qZXNsaW50IG5vLXVudXNlZC12YXJzOiBcIm9mZlwiKi9cblxuaW1wb3J0IHVwZGF0ZUluIGZyb20gJ3NpbXBsZS11cGRhdGUtaW4nO1xuXG5pbXBvcnQgeyBJTkNPTUlOR19BQ1RJVklUWSB9IGZyb20gJy4uL2FjdGlvbnMvaW5jb21pbmdBY3Rpdml0eSc7XG5cbmNvbnN0IERFRkFVTFRfU1RBVEUgPSB7fTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbGFzdFR5cGluZ0F0KHN0YXRlID0gREVGQVVMVF9TVEFURSwgeyBwYXlsb2FkLCB0eXBlIH0pIHtcbiAgaWYgKHR5cGUgPT09IElOQ09NSU5HX0FDVElWSVRZKSB7XG4gICAgY29uc3Qge1xuICAgICAgYWN0aXZpdHk6IHtcbiAgICAgICAgZnJvbTogeyBpZCwgcm9sZSB9LFxuICAgICAgICB0eXBlOiBhY3Rpdml0eVR5cGVcbiAgICAgIH1cbiAgICB9ID0gcGF5bG9hZDtcblxuICAgIGlmIChyb2xlICE9PSAndXNlcicpIHtcbiAgICAgIGlmIChhY3Rpdml0eVR5cGUgPT09ICd0eXBpbmcnKSB7XG4gICAgICAgIHN0YXRlID0gdXBkYXRlSW4oc3RhdGUsIFtpZF0sICgpID0+IERhdGUubm93KCkpO1xuICAgICAgfSBlbHNlIGlmIChhY3Rpdml0eVR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgICBzdGF0ZSA9IHVwZGF0ZUluKHN0YXRlLCBbaWRdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc3RhdGU7XG59XG4iXX0=