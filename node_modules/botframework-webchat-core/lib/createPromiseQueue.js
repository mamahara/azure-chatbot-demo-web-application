"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = createPromiseQueue;

var _pDeferEs = _interopRequireDefault(require("p-defer-es5"));

function createPromiseQueue() {
  var deferred;
  var queue = [];

  var push = function push(value) {
    if (deferred) {
      var _deferred = deferred,
          resolve = _deferred.resolve;
      deferred = null;
      resolve(value);
    } else {
      queue.push(value);
    }
  };

  var shift = function shift() {
    return queue.length ? Promise.resolve(queue.shift()) : (deferred || (deferred = (0, _pDeferEs["default"])())).promise;
  };

  return {
    push: push,
    shift: shift
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jcmVhdGVQcm9taXNlUXVldWUuanMiXSwibmFtZXMiOlsiY3JlYXRlUHJvbWlzZVF1ZXVlIiwiZGVmZXJyZWQiLCJxdWV1ZSIsInB1c2giLCJ2YWx1ZSIsInJlc29sdmUiLCJzaGlmdCIsImxlbmd0aCIsIlByb21pc2UiLCJwcm9taXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFFZSxTQUFTQSxrQkFBVCxHQUE4QjtBQUMzQyxNQUFJQyxRQUFKO0FBQ0EsTUFBTUMsS0FBSyxHQUFHLEVBQWQ7O0FBRUEsTUFBTUMsSUFBSSxHQUFHLFNBQVBBLElBQU8sQ0FBQUMsS0FBSyxFQUFJO0FBQ3BCLFFBQUlILFFBQUosRUFBYztBQUFBLHNCQUNRQSxRQURSO0FBQUEsVUFDSkksT0FESSxhQUNKQSxPQURJO0FBR1pKLE1BQUFBLFFBQVEsR0FBRyxJQUFYO0FBQ0FJLE1BQUFBLE9BQU8sQ0FBQ0QsS0FBRCxDQUFQO0FBQ0QsS0FMRCxNQUtPO0FBQ0xGLE1BQUFBLEtBQUssQ0FBQ0MsSUFBTixDQUFXQyxLQUFYO0FBQ0Q7QUFDRixHQVREOztBQVdBLE1BQU1FLEtBQUssR0FBRyxTQUFSQSxLQUFRO0FBQUEsV0FDWkosS0FBSyxDQUFDSyxNQUFOLEdBQWVDLE9BQU8sQ0FBQ0gsT0FBUixDQUFnQkgsS0FBSyxDQUFDSSxLQUFOLEVBQWhCLENBQWYsR0FBZ0QsQ0FBQ0wsUUFBUSxLQUFLQSxRQUFRLEdBQUcsMkJBQWhCLENBQVQsRUFBNENRLE9BRGhGO0FBQUEsR0FBZDs7QUFHQSxTQUFPO0FBQ0xOLElBQUFBLElBQUksRUFBSkEsSUFESztBQUVMRyxJQUFBQSxLQUFLLEVBQUxBO0FBRkssR0FBUDtBQUlEIiwic291cmNlUm9vdCI6ImNvcmU6Ly8vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZURlZmVycmVkIGZyb20gJ3AtZGVmZXItZXM1JztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlUHJvbWlzZVF1ZXVlKCkge1xuICBsZXQgZGVmZXJyZWQ7XG4gIGNvbnN0IHF1ZXVlID0gW107XG5cbiAgY29uc3QgcHVzaCA9IHZhbHVlID0+IHtcbiAgICBpZiAoZGVmZXJyZWQpIHtcbiAgICAgIGNvbnN0IHsgcmVzb2x2ZSB9ID0gZGVmZXJyZWQ7XG5cbiAgICAgIGRlZmVycmVkID0gbnVsbDtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBxdWV1ZS5wdXNoKHZhbHVlKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2hpZnQgPSAoKSA9PlxuICAgIHF1ZXVlLmxlbmd0aCA/IFByb21pc2UucmVzb2x2ZShxdWV1ZS5zaGlmdCgpKSA6IChkZWZlcnJlZCB8fCAoZGVmZXJyZWQgPSBjcmVhdGVEZWZlcnJlZCgpKSkucHJvbWlzZTtcblxuICByZXR1cm4ge1xuICAgIHB1c2gsXG4gICAgc2hpZnRcbiAgfTtcbn1cbiJdfQ==