"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _callee;

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _sleep = _interopRequireDefault(require("./sleep"));

function _callee(fn, numRetries, interval) {
  var lastError, times;
  return _regenerator["default"].async(function _callee$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          times = 0;

        case 1:
          if (!(times < numRetries)) {
            _context.next = 17;
            break;
          }

          if (!times) {
            _context.next = 5;
            break;
          }

          _context.next = 5;
          return _regenerator["default"].awrap((0, _sleep["default"])(interval));

        case 5:
          _context.prev = 5;
          _context.next = 8;
          return _regenerator["default"].awrap(fn());

        case 8:
          return _context.abrupt("return", _context.sent);

        case 11:
          _context.prev = 11;
          _context.t0 = _context["catch"](5);
          lastError = _context.t0;

        case 14:
          times++;
          _context.next = 1;
          break;

        case 17:
          throw lastError;

        case 18:
        case "end":
          return _context.stop();
      }
    }
  }, null, null, [[5, 11]]);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXRyeS5qcyJdLCJuYW1lcyI6WyJmbiIsIm51bVJldHJpZXMiLCJpbnRlcnZhbCIsInRpbWVzIiwibGFzdEVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUVlLGlCQUFnQkEsRUFBaEIsRUFBb0JDLFVBQXBCLEVBQWdDQyxRQUFoQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHSkMsVUFBQUEsS0FISSxHQUdJLENBSEo7O0FBQUE7QUFBQSxnQkFHT0EsS0FBSyxHQUFHRixVQUhmO0FBQUE7QUFBQTtBQUFBOztBQUFBLGVBSVBFLEtBSk87QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQSwrQ0FLSCx1QkFBTUQsUUFBTixDQUxHOztBQUFBO0FBQUE7QUFBQTtBQUFBLCtDQVNJRixFQUFFLEVBVE47O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFXVEksVUFBQUEsU0FBUyxjQUFUOztBQVhTO0FBRzJCRCxVQUFBQSxLQUFLLEVBSGhDO0FBQUE7QUFBQTs7QUFBQTtBQUFBLGdCQWVQQyxTQWZPOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHNsZWVwIGZyb20gJy4vc2xlZXAnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiAoZm4sIG51bVJldHJpZXMsIGludGVydmFsKSB7XG4gIGxldCBsYXN0RXJyb3I7XG5cbiAgZm9yIChsZXQgdGltZXMgPSAwOyB0aW1lcyA8IG51bVJldHJpZXM7IHRpbWVzKyspIHtcbiAgICBpZiAodGltZXMpIHtcbiAgICAgIGF3YWl0IHNsZWVwKGludGVydmFsKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGZuKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxhc3RFcnJvciA9IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHRocm93IGxhc3RFcnJvcjtcbn1cbiJdfQ==