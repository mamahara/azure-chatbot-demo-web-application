"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = useImmediateEffect;

var _react = require("react");

function useImmediateEffect(fn, deps) {
  var unsubscribeRef = (0, _react.useRef)({
    first: true,
    id: Math.random().toString(36).substr(2, 5),
    unsubscribe: fn()
  });
  (0, _react.useEffect)(function () {
    var current = unsubscribeRef.current;

    if (!current.first) {
      current.unsubscribe = fn();
    } else {
      current.first = false;
    }

    return function () {
      current.unsubscribe && current.unsubscribe();
      current.unsubscribe = null;
    };
  }, deps);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy91c2VJbW1lZGlhdGVFZmZlY3QuanMiXSwibmFtZXMiOlsidXNlSW1tZWRpYXRlRWZmZWN0IiwiZm4iLCJkZXBzIiwidW5zdWJzY3JpYmVSZWYiLCJmaXJzdCIsImlkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwidW5zdWJzY3JpYmUiLCJjdXJyZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRWUsU0FBU0Esa0JBQVQsQ0FBNEJDLEVBQTVCLEVBQWdDQyxJQUFoQyxFQUFzQztBQUNuRCxNQUFNQyxjQUFjLEdBQUcsbUJBQU87QUFDNUJDLElBQUFBLEtBQUssRUFBRSxJQURxQjtBQUU1QkMsSUFBQUEsRUFBRSxFQUFFQyxJQUFJLENBQUNDLE1BQUwsR0FBY0MsUUFBZCxDQUF1QixFQUF2QixFQUEyQkMsTUFBM0IsQ0FBa0MsQ0FBbEMsRUFBcUMsQ0FBckMsQ0FGd0I7QUFHNUJDLElBQUFBLFdBQVcsRUFBRVQsRUFBRTtBQUhhLEdBQVAsQ0FBdkI7QUFNQSx3QkFBVSxZQUFNO0FBQUEsUUFDTlUsT0FETSxHQUNNUixjQUROLENBQ05RLE9BRE07O0FBR2QsUUFBSSxDQUFDQSxPQUFPLENBQUNQLEtBQWIsRUFBb0I7QUFDbEJPLE1BQUFBLE9BQU8sQ0FBQ0QsV0FBUixHQUFzQlQsRUFBRSxFQUF4QjtBQUNELEtBRkQsTUFFTztBQUNMVSxNQUFBQSxPQUFPLENBQUNQLEtBQVIsR0FBZ0IsS0FBaEI7QUFDRDs7QUFFRCxXQUFPLFlBQU07QUFDWE8sTUFBQUEsT0FBTyxDQUFDRCxXQUFSLElBQXVCQyxPQUFPLENBQUNELFdBQVIsRUFBdkI7QUFDQUMsTUFBQUEsT0FBTyxDQUFDRCxXQUFSLEdBQXNCLElBQXRCO0FBQ0QsS0FIRDtBQUlELEdBYkQsRUFhR1IsSUFiSDtBQWNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVzZUltbWVkaWF0ZUVmZmVjdChmbiwgZGVwcykge1xuICBjb25zdCB1bnN1YnNjcmliZVJlZiA9IHVzZVJlZih7XG4gICAgZmlyc3Q6IHRydWUsXG4gICAgaWQ6IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA1KSxcbiAgICB1bnN1YnNjcmliZTogZm4oKVxuICB9KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudCB9ID0gdW5zdWJzY3JpYmVSZWY7XG5cbiAgICBpZiAoIWN1cnJlbnQuZmlyc3QpIHtcbiAgICAgIGN1cnJlbnQudW5zdWJzY3JpYmUgPSBmbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50LmZpcnN0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN1cnJlbnQudW5zdWJzY3JpYmUgJiYgY3VycmVudC51bnN1YnNjcmliZSgpO1xuICAgICAgY3VycmVudC51bnN1YnNjcmliZSA9IG51bGw7XG4gICAgfTtcbiAgfSwgZGVwcyk7XG59XG4iXX0=